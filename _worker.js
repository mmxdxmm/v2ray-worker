"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _cloudflareSockets=require("cloudflare:sockets"),_excluded=["merged"];function _objectWithoutProperties(e,t){if(null==e)return{};var n,r,i=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function asyncGeneratorStep(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){asyncGeneratorStep(o,r,i,a,s,"next",e)}function s(e){asyncGeneratorStep(o,r,i,a,s,"throw",e)}a(void 0)}))}}
/*!
  * v2ray Subscription Worker v2.4
  * Copyright 2024 Vahid Farid (https://twitter.com/vahidfarid)
  * Licensed under GPLv3 (https://github.com/vfarid/v2ray-worker/blob/main/Licence.md)
  */var __create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__require=(e=>"undefined"!=typeof require?require:"undefined"!=typeof Proxy?new Proxy(e,{get:(e,t)=>("undefined"!=typeof require?require:e)[t]}):e)((function(e){if("undefined"!=typeof require)return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')})),__esm=(e,t)=>function(){return e&&(t=(0,e[__getOwnPropNames(e)[0]])(e=0)),t},__commonJS=(e,t)=>function(){return t||(0,e[__getOwnPropNames(e)[0]])((t={exports:{}}).exports,t),t.exports},__copyProps=(e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t){var i=function(i){__hasOwnProp.call(e,i)||i===n||__defProp(e,i,{get:()=>t[i],enumerable:!(r=__getOwnPropDesc(t,i))||r.enumerable})};for(var o of __getOwnPropNames(t))i(o)}return e},__toESM=(e,t,n)=>(n=null!=e?__create(__getProtoOf(e)):{},__copyProps(!t&&e&&e.__esModule?n:__defProp(n,"default",{value:e,enumerable:!0}),e)),init_wrangler_modules_watch=__esm({"wrangler-modules-watch:wrangler:modules-watch"(){init_modules_watch_stub()}}),init_modules_watch_stub=__esm({"node_modules/wrangler/templates/modules-watch-stub.js"(){init_wrangler_modules_watch()}}),require_crypto=__commonJS({"(disabled):crypto"(){init_modules_watch_stub()}}),require_core=__commonJS({"node_modules/crypto-js/core.js"(e,t){var n,r;init_modules_watch_stub(),n=e,r=function(){var e=e||function(e){var t;if("undefined"!=typeof window&&window.crypto&&(t=window.crypto),"undefined"!=typeof self&&self.crypto&&(t=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(t=globalThis.crypto),!t&&"undefined"!=typeof window&&window.msCrypto&&(t=window.msCrypto),!t&&"undefined"!=typeof global&&global.crypto&&(t=global.crypto),!t&&"function"==typeof __require)try{t=require_crypto()}catch(e){}var n=function(){if(t){if("function"==typeof t.getRandomValues)try{return t.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof t.randomBytes)try{return t.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},r=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},o=i.lib={},a=o.Base={extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=o.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var a=n[o>>>2]>>>24-o%4*8&255;t[r+o>>>2]|=a<<24-(r+o)%4*8}else for(var s=0;s<i;s+=4)t[r+s>>>2]=n[s>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(n());return new s.init(t,e)}}),l=i.enc={},c=l.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(n,t/2)}},u=l.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new s.init(n,t)}},p=l.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=o.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r=this._data,i=r.words,o=r.sigBytes,a=this.blockSize,l=o/(4*a),c=(l=t?e.ceil(l):e.max((0|l)-this._minBufferSize,0))*a,u=e.min(4*c,o);if(c){for(var p=0;p<c;p+=a)this._doProcessBlock(i,p);n=i.splice(0,c),r.sigBytes-=u}return new s.init(n,u)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),f=(o.Hasher=d.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}}),i.algo={});return i}(Math);return e},"object"==typeof e?t.exports=e=r():"function"==typeof define&&define.amd?define([],r):n.CryptoJS=r()}}),require_sha256=__commonJS({"node_modules/crypto-js/sha256.js"(e,t){var n,r;init_modules_watch_stub(),n=e,r=function(e){return function(t){var n=e,r=n.lib,i=r.WordArray,o=r.Hasher,a=n.algo,s=[],l=[];!function(){function e(e){for(var n=t.sqrt(e),r=2;r<=n;r++)if(!(e%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,i=0;i<64;)e(r)&&(i<8&&(s[i]=n(t.pow(r,.5))),l[i]=n(t.pow(r,1/3)),i++),r++}();var c=[],u=a.SHA256=o.extend({_doReset:function(){this._hash=new i.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],p=n[6],d=n[7],f=0;f<64;f++){if(f<16)c[f]=0|e[t+f];else{var h=c[f-15],g=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,m=c[f-2],y=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;c[f]=g+c[f-7]+y+c[f-16]}var v=r&i^r&o^i&o,b=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),_=d+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&u^~s&p)+l[f]+c[f];d=p,p=u,u=s,s=a+_|0,a=o,o=i,i=r,r=_+(b+v)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+u|0,n[6]=n[6]+p|0,n[7]=n[7]+d|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=t.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=o._createHelper(u),n.HmacSHA256=o._createHmacHelper(u)}(Math),e.SHA256},"object"==typeof e?t.exports=e=r(require_core()):"function"==typeof define&&define.amd?define(["./core"],r):r(n.CryptoJS)}}),require_sha224=__commonJS({"node_modules/crypto-js/sha224.js"(e,t){var n,r;init_modules_watch_stub(),n=e,r=function(e){var t,n,r,i,o;return n=(t=e).lib.WordArray,r=t.algo,i=r.SHA256,o=r.SHA224=i.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=i._doFinalize.call(this);return e.sigBytes-=4,e}}),t.SHA224=i._createHelper(o),t.HmacSHA224=i._createHmacHelper(o),e.SHA224},"object"==typeof e?t.exports=e=r(require_core(),require_sha256()):"function"==typeof define&&define.amd?define(["./core","./sha256"],r):r(n.CryptoJS)}}),require_enc_hex=__commonJS({"node_modules/crypto-js/enc-hex.js"(e,t){var n,r;init_modules_watch_stub(),n=e,r=function(e){return e.enc.Hex},"object"==typeof e?t.exports=e=r(require_core()):"function"==typeof define&&define.amd?define(["./core"],r):r(n.CryptoJS)}}),require_bcrypt=__commonJS({"node_modules/bcryptjs/dist/bcrypt.js"(e,t){var n,r;init_modules_watch_stub(),n=e,r=function(){var e={},n=null;function r(e){if(void 0!==t&&t&&t.exports)try{return __require("crypto").randomBytes(e)}catch(e){}try{var r;return(self.crypto||self.msCrypto).getRandomValues(r=new Uint32Array(e)),Array.prototype.slice.call(r)}catch(e){}if(!n)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return n(e)}try{r(1)}catch(e){}function i(e,t){for(var n=0,r=0,i=0,o=e.length;i<o;++i)e.charCodeAt(i)===t.charCodeAt(i)?++n:++r;return!(n<0)&&0===r}n=null,e.setRandomFallback=function(e){n=e},e.genSaltSync=function(e,t){if("number"!=typeof(e=e||h))throw Error("Illegal arguments: "+typeof e+", "+typeof t);e<4?e=4:e>31&&(e=31);var n=[];return n.push("$2a$"),e<10&&n.push("0"),n.push(e.toString()),n.push("$"),n.push(c(r(f),f)),n.join("")},e.genSalt=function(t,n,r){if("function"==typeof n&&(r=n,n=void 0),"function"==typeof t&&(r=t,t=void 0),void 0===t)t=h;else if("number"!=typeof t)throw Error("illegal arguments: "+typeof t);function i(n){o((function(){try{n(null,e.genSaltSync(t))}catch(e){n(e)}}))}if(!r)return new Promise((function(e,t){i((function(n,r){n?t(n):e(r)}))}));if("function"!=typeof r)throw Error("Illegal callback: "+typeof r);i(r)},e.hashSync=function(t,n){if(void 0===n&&(n=h),"number"==typeof n&&(n=e.genSaltSync(n)),"string"!=typeof t||"string"!=typeof n)throw Error("Illegal arguments: "+typeof t+", "+typeof n);return S(t,n)},e.hash=function(t,n,r,i){function a(r){"string"==typeof t&&"number"==typeof n?e.genSalt(n,(function(e,n){S(t,n,r,i)})):"string"==typeof t&&"string"==typeof n?S(t,n,r,i):o(r.bind(this,Error("Illegal arguments: "+typeof t+", "+typeof n)))}if(!r)return new Promise((function(e,t){a((function(n,r){n?t(n):e(r)}))}));if("function"!=typeof r)throw Error("Illegal callback: "+typeof r);a(r)},e.compareSync=function(t,n){if("string"!=typeof t||"string"!=typeof n)throw Error("Illegal arguments: "+typeof t+", "+typeof n);return 60===n.length&&i(e.hashSync(t,n.substr(0,n.length-31)),n)},e.compare=function(t,n,r,a){function s(r){"string"==typeof t&&"string"==typeof n?60===n.length?e.hash(t,n.substr(0,29),(function(e,t){e?r(e):r(null,i(t,n))}),a):o(r.bind(this,null,!1)):o(r.bind(this,Error("Illegal arguments: "+typeof t+", "+typeof n)))}if(!r)return new Promise((function(e,t){s((function(n,r){n?t(n):e(r)}))}));if("function"!=typeof r)throw Error("Illegal callback: "+typeof r);s(r)},e.getRounds=function(e){if("string"!=typeof e)throw Error("Illegal arguments: "+typeof e);return parseInt(e.split("$")[2],10)},e.getSalt=function(e){if("string"!=typeof e)throw Error("Illegal arguments: "+typeof e);if(60!==e.length)throw Error("Illegal hash length: "+e.length+" != 60");return e.substring(0,29)};var o="undefined"!=typeof process&&process&&"function"==typeof process.nextTick?"function"==typeof setImmediate?setImmediate:process.nextTick:setTimeout,a="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),s=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1],l=String.fromCharCode;function c(e,t){var n,r,i=0,o=[];if(t<=0||t>e.length)throw Error("Illegal len: "+t);for(;i<t;){if(n=255&e[i++],o.push(a[n>>2&63]),n=(3&n)<<4,i>=t){o.push(a[63&n]);break}if(n|=(r=255&e[i++])>>4&15,o.push(a[63&n]),n=(15&r)<<2,i>=t){o.push(a[63&n]);break}n|=(r=255&e[i++])>>6&3,o.push(a[63&n]),o.push(a[63&r])}return o.join("")}function u(e,t){var n,r,i,o,a,c=0,u=e.length,p=0,d=[];if(t<=0)throw Error("Illegal len: "+t);for(;c<u-1&&p<t&&(n=(a=e.charCodeAt(c++))<s.length?s[a]:-1,r=(a=e.charCodeAt(c++))<s.length?s[a]:-1,-1!=n&&-1!=r)&&(o=n<<2>>>0,o|=(48&r)>>4,d.push(l(o)),!(++p>=t||c>=u))&&-1!=(i=(a=e.charCodeAt(c++))<s.length?s[a]:-1)&&(o=(15&r)<<4>>>0,o|=(60&i)>>2,d.push(l(o)),!(++p>=t||c>=u));)o=(3&i)<<6>>>0,o|=(a=e.charCodeAt(c++))<s.length?s[a]:-1,d.push(l(o)),++p;var f=[];for(c=0;c<p;c++)f.push(d[c].charCodeAt(0));return f}var p,d=p={MAX_CODEPOINT:1114111,encodeUTF8:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<128?t(127&n):n<2048?(t(n>>6&31|192),t(63&n|128)):n<65536?(t(n>>12&15|224),t(n>>6&63|128),t(63&n|128)):(t(n>>18&7|240),t(n>>12&63|128),t(n>>6&63|128),t(63&n|128)),n=null},decodeUTF8:function(e,t){for(var n,r,i,o,a=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(n=e());)if(128&n)if(192==(224&n))null===(r=e())&&a([n,r]),t((31&n)<<6|63&r);else if(224==(240&n))(null===(r=e())||null===(i=e()))&&a([n,r,i]),t((15&n)<<12|(63&r)<<6|63&i);else{if(240!=(248&n))throw RangeError("Illegal starting byte: "+n);(null===(r=e())||null===(i=e())||null===(o=e()))&&a([n,r,i,o]),t((7&n)<<18|(63&r)<<12|(63&i)<<6|63&o)}else t(n)},UTF16toUTF8:function(e,t){for(var n,r=null;null!==(n=null!==r?r:e());)n>=55296&&n<=57343&&null!==(r=e())&&r>=56320&&r<=57343?(t(1024*(n-55296)+r-56320+65536),r=null):t(n);null!==r&&t(r)},UTF8toUTF16:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<=65535?t(n):(t(55296+((n-=65536)>>10)),t(n%1024+56320)),n=null},encodeUTF16toUTF8:function(e,t){p.UTF16toUTF8(e,(function(e){p.encodeUTF8(e,t)}))},decodeUTF8toUTF16:function(e,t){p.decodeUTF8(e,(function(e){p.UTF8toUTF16(e,t)}))},calculateCodePoint:function(e){return e<128?1:e<2048?2:e<65536?3:4},calculateUTF8:function(e){for(var t,n=0;null!==(t=e());)n+=p.calculateCodePoint(t);return n},calculateUTF16asUTF8:function(e){var t=0,n=0;return p.UTF16toUTF8(e,(function(e){++t,n+=p.calculateCodePoint(e)})),[t,n]}};Date.now=Date.now||function(){return+new Date};var f=16,h=10,g=16,m=100,y=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],v=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],b=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function _(e,t,n,r){var i,o=e[t],a=e[t+1];return i=r[(o^=n[0])>>>24],i+=r[256|o>>16&255],i^=r[512|o>>8&255],i=r[(a^=(i+=r[768|255&o])^n[1])>>>24],i+=r[256|a>>16&255],i^=r[512|a>>8&255],i=r[(o^=(i+=r[768|255&a])^n[2])>>>24],i+=r[256|o>>16&255],i^=r[512|o>>8&255],i=r[(a^=(i+=r[768|255&o])^n[3])>>>24],i+=r[256|a>>16&255],i^=r[512|a>>8&255],i=r[(o^=(i+=r[768|255&a])^n[4])>>>24],i+=r[256|o>>16&255],i^=r[512|o>>8&255],i=r[(a^=(i+=r[768|255&o])^n[5])>>>24],i+=r[256|a>>16&255],i^=r[512|a>>8&255],i=r[(o^=(i+=r[768|255&a])^n[6])>>>24],i+=r[256|o>>16&255],i^=r[512|o>>8&255],i=r[(a^=(i+=r[768|255&o])^n[7])>>>24],i+=r[256|a>>16&255],i^=r[512|a>>8&255],i=r[(o^=(i+=r[768|255&a])^n[8])>>>24],i+=r[256|o>>16&255],i^=r[512|o>>8&255],i=r[(a^=(i+=r[768|255&o])^n[9])>>>24],i+=r[256|a>>16&255],i^=r[512|a>>8&255],i=r[(o^=(i+=r[768|255&a])^n[10])>>>24],i+=r[256|o>>16&255],i^=r[512|o>>8&255],i=r[(a^=(i+=r[768|255&o])^n[11])>>>24],i+=r[256|a>>16&255],i^=r[512|a>>8&255],i=r[(o^=(i+=r[768|255&a])^n[12])>>>24],i+=r[256|o>>16&255],i^=r[512|o>>8&255],i=r[(a^=(i+=r[768|255&o])^n[13])>>>24],i+=r[256|a>>16&255],i^=r[512|a>>8&255],i=r[(o^=(i+=r[768|255&a])^n[14])>>>24],i+=r[256|o>>16&255],i^=r[512|o>>8&255],i=r[(a^=(i+=r[768|255&o])^n[15])>>>24],i+=r[256|a>>16&255],i^=r[512|a>>8&255],o^=(i+=r[768|255&a])^n[16],e[t]=a^n[g+1],e[t+1]=o,e}function w(e,t){for(var n=0,r=0;n<4;++n)r=r<<8|255&e[t],t=(t+1)%e.length;return{key:r,offp:t}}function E(e,t,n){for(var r,i=0,o=[0,0],a=t.length,s=n.length,l=0;l<a;l++)i=(r=w(e,i)).offp,t[l]=t[l]^r.key;for(l=0;l<a;l+=2)o=_(o,0,t,n),t[l]=o[0],t[l+1]=o[1];for(l=0;l<s;l+=2)o=_(o,0,t,n),n[l]=o[0],n[l+1]=o[1]}function A(e,t,n,r,i){var a,s=b.slice(),l=s.length;if(n<4||n>31){if(a=Error("Illegal number of rounds (4-31): "+n),r)return void o(r.bind(this,a));throw a}if(t.length!==f){if(a=Error("Illegal salt length: "+t.length+" != "+f),r)return void o(r.bind(this,a));throw a}n=1<<n>>>0;var c,u,p,d=0;function h(){if(i&&i(d/n),!(d<n)){for(d=0;d<64;d++)for(p=0;p<l>>1;p++)_(s,p<<1,c,u);var a=[];for(d=0;d<l;d++)a.push((s[d]>>24&255)>>>0),a.push((s[d]>>16&255)>>>0),a.push((s[d]>>8&255)>>>0),a.push((255&s[d])>>>0);return r?void r(null,a):a}for(var f=Date.now();d<n&&(d+=1,E(e,c,u),E(t,c,u),!(Date.now()-f>m)););r&&o(h)}if(Int32Array?(c=new Int32Array(y),u=new Int32Array(v)):(c=y.slice(),u=v.slice()),function(e,t,n,r){for(var i,o=0,a=[0,0],s=n.length,l=r.length,c=0;c<s;c++)o=(i=w(t,o)).offp,n[c]=n[c]^i.key;for(o=0,c=0;c<s;c+=2)o=(i=w(e,o)).offp,a[0]^=i.key,o=(i=w(e,o)).offp,a[1]^=i.key,a=_(a,0,n,r),n[c]=a[0],n[c+1]=a[1];for(c=0;c<l;c+=2)o=(i=w(e,o)).offp,a[0]^=i.key,o=(i=w(e,o)).offp,a[1]^=i.key,a=_(a,0,n,r),r[c]=a[0],r[c+1]=a[1]}(t,e,c,u),void 0!==r)h();else for(var g;;)if(void 0!==(g=h()))return g||[]}function S(e,t,n,r){var i,a,s;if("string"!=typeof e||"string"!=typeof t){if(i=Error("Invalid string / salt: Not a string"),n)return void o(n.bind(this,i));throw i}if("$"!==t.charAt(0)||"2"!==t.charAt(1)){if(i=Error("Invalid salt version: "+t.substring(0,2)),n)return void o(n.bind(this,i));throw i}if("$"===t.charAt(2))a=String.fromCharCode(0),s=3;else{if("a"!==(a=t.charAt(2))&&"b"!==a&&"y"!==a||"$"!==t.charAt(3)){if(i=Error("Invalid salt revision: "+t.substring(2,4)),n)return void o(n.bind(this,i));throw i}s=4}if(t.charAt(s+2)>"$"){if(i=Error("Missing salt rounds"),n)return void o(n.bind(this,i));throw i}var l=10*parseInt(t.substring(s,s+1),10)+parseInt(t.substring(s+1,s+2),10),p=t.substring(s+3,s+25),h=function(e){var t=[],n=0;return d.encodeUTF16toUTF8((function(){return n>=e.length?null:e.charCodeAt(n++)}),(function(e){t.push(e)})),t}(e+=a>="a"?"\0":""),g=u(p,f);function m(e){var t=[];return t.push("$2"),a>="a"&&t.push(a),t.push("$"),l<10&&t.push("0"),t.push(l.toString()),t.push("$"),t.push(c(g,g.length)),t.push(c(e,4*b.length-1)),t.join("")}if(void 0===n)return m(A(h,g,l));A(h,g,l,(function(e,t){e?n(e,null):n(null,m(t))}),r)}return e.encodeBase64=c,e.decodeBase64=u,e},"function"==typeof define&&define.amd?define([],r):"function"==typeof __require&&"object"==typeof t&&t&&t.exports?t.exports=r():(n.dcodeIO=n.dcodeIO||{}).bcrypt=r()}}),require_base64_js=__commonJS({"node_modules/base64-js/index.js"(e){init_modules_watch_stub(),e.byteLength=function(e){var t=a(e),n=t[0],r=t[1];return 3*(n+r)/4-r},e.toByteArray=function(e){var t,n,o=a(e),s=o[0],l=o[1],c=new i(function(e,t,n){return 3*(t+n)/4-n}(0,s,l)),u=0,p=l>0?s-4:s;for(n=0;n<p;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;2===l&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,c[u++]=255&t);1===l&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t);return c},e.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],a=16383,l=0,c=r-i;l<c;l+=a)o.push(s(e,l,l+a>c?c:l+a));1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};var t,n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(t=0,64;t<64;++t)n[t]=o[t],r[o.charCodeAt(t)]=t;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function s(e,t,r){for(var i,o,a=[],s=t;s<r;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return a.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63}}),require_ieee754=__commonJS({"node_modules/ieee754/index.js"(e){init_modules_watch_stub(),e.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,l=(1<<s)-1,c=l>>1,u=-7,p=n?i-1:0,d=n?-1:1,f=e[t+p];for(p+=d,o=f&(1<<-u)-1,f>>=-u,u+=s;u>0;o=256*o+e[t+p],p+=d,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=r;u>0;a=256*a+e[t+p],p+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),o-=c}return(f?-1:1)*a*Math.pow(2,o-r)},e.write=function(e,t,n,r,i,o){var a,s,l,c=8*o-i-1,u=(1<<c)-1,p=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,h=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+p>=1?d/l:d*Math.pow(2,1-p))*l>=2&&(a++,l/=2),a+p>=u?(s=0,a=u):a+p>=1?(s=(t*l-1)*Math.pow(2,i),a+=p):(s=t*Math.pow(2,p-1)*Math.pow(2,i),a=0));i>=8;e[n+f]=255&s,f+=h,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[n+f]=255&a,f+=h,a/=256,c-=8);e[n+f-h]|=128*g}}}),require_buffer=__commonJS({"node_modules/buffer/index.js"(e){init_modules_watch_stub();var t=require_base64_js(),n=require_ieee754(),r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=a,e.SlowBuffer=function(e){+e!=e&&(e=0);return a.alloc(+e)},e.INSPECT_MAX_BYTES=50;var i=2147483647;function o(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,a.prototype),t}function a(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return c(e)}return s(e,t,n)}function s(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!a.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|f(e,t),r=o(n),i=r.write(e,t);i!==n&&(r=r.slice(0,i));return r}(e,t);if(ArrayBuffer.isView(e))return function(e){if($(e,Uint8Array)){var t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if($(e,ArrayBuffer)||e&&$(e.buffer,ArrayBuffer))return p(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&($(e,SharedArrayBuffer)||e&&$(e.buffer,SharedArrayBuffer)))return p(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return a.from(r,t,n);var i=function(e){if(a.isBuffer(e)){var t=0|d(e.length),n=o(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||K(e.length)?o(0):u(e);if("Buffer"===e.type&&Array.isArray(e.data))return u(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return l(e),o(e<0?0:0|d(e))}function u(e){for(var t=e.length<0?0:0|d(e.length),n=o(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function p(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,a.prototype),r}function d(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function f(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||$(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return q(e).length;default:if(i)return r?-1:G(e).length;t=(""+t).toLowerCase(),i=!0}}function h(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,n);case"utf8":case"utf-8":return S(this,t,n);case"ascii":return k(this,t,n);case"latin1":case"binary":return C(this,t,n);case"base64":return A(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function m(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),K(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=a.from(t,r)),a.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,i){var o,a=1,s=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var u=-1;for(o=n;o<s;o++)if(c(e,o)===c(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*a}else-1!==u&&(o-=o-u),u=-1}else for(n+l>s&&(n=s-l),o=n;o>=0;o--){for(var p=!0,d=0;d<l;d++)if(c(e,o+d)!==c(t,d)){p=!1;break}if(p)return o}return-1}function v(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o,a=t.length;for(r>a/2&&(r=a/2),o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(K(s))return o;e[n+o]=s}return o}function b(e,t,n,r){return V(G(t,e.length-n),e,n,r)}function _(e,t,n,r){return V(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function w(e,t,n,r){return V(q(t),e,n,r)}function E(e,t,n,r){return V(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function A(e,n,r){return 0===n&&r===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(n,r))}function S(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o=e[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s<=n){var l=void 0,c=void 0,u=void 0,p=void 0;switch(s){case 1:o<128&&(a=o);break;case 2:128==(192&(l=e[i+1]))&&(p=(31&o)<<6|63&l)>127&&(a=p);break;case 3:l=e[i+1],c=e[i+2],128==(192&l)&&128==(192&c)&&(p=(15&o)<<12|(63&l)<<6|63&c)>2047&&(p<55296||p>57343)&&(a=p);break;case 4:l=e[i+1],c=e[i+2],u=e[i+3],128==(192&l)&&128==(192&c)&&128==(192&u)&&(p=(15&o)<<18|(63&l)<<12|(63&c)<<6|63&u)>65535&&p<1114112&&(a=p)}}null===a?(a=65533,s=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),i+=s}return function(e){var t=e.length;if(t<=T)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=T));return n}(r)}e.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(e,t,n){return s(e,t,n)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(e,t,n){return function(e,t,n){return l(e),e<=0?o(e):void 0!==t?"string"==typeof n?o(e).fill(t,n):o(e).fill(t):o(e)}(e,t,n)},a.allocUnsafe=function(e){return c(e)},a.allocUnsafeSlow=function(e){return c(e)},a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if($(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),$(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=a.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if($(o,Uint8Array))i+o.length>r.length?(a.isBuffer(o)||(o=a.from(o)),o.copy(r,i)):Uint8Array.prototype.set.call(r,o,i);else{if(!a.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i)}i+=o.length}return r},a.byteLength=f,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},a.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?S(this,0,e):h.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(e,t,n,r,i){if($(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),l=Math.min(o,s),c=this.slice(r,i),u=e.slice(t,n),p=0;p<l;++p)if(c[p]!==u[p]){o=c[p],s=u[p];break}return o<s?-1:s<o?1:0},a.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},a.prototype.indexOf=function(e,t,n){return m(this,e,t,n,!0)},a.prototype.lastIndexOf=function(e,t,n){return m(this,e,t,n,!1)},a.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":case"latin1":case"binary":return _(this,e,t,n);case"base64":return w(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function k(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function C(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function I(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=X[e[o]];return i}function L(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length-1;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function O(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function x(e,t,n,r,i,o){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function P(e,t,n,r,i){D(t,r,i,e,n,7);var o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;var a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,n}function R(e,t,n,r,i){D(t,r,i,e,n,7);var o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;var a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=a,a>>=8,e[n+2]=a,a>>=8,e[n+1]=a,a>>=8,e[n]=a,n+8}function B(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function N(e,t,r,i,o){return t=+t,r>>>=0,o||B(e,0,r,4),n.write(e,t,r,i,23,4),r+4}function U(e,t,r,i,o){return t=+t,r>>>=0,o||B(e,0,r,8),n.write(e,t,r,i,52,8),r+8}a.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,a.prototype),r},a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),this[e]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readBigUInt64LE=Q((function(e){F(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Y(e,this.length-8);var r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),a.prototype.readBigUInt64BE=Q((function(e){F(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Y(e,this.length-8);var r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),a.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},a.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},a.prototype.readInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||O(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt16BE=function(e,t){e>>>=0,t||O(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readBigInt64LE=Q((function(e){F(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Y(e,this.length-8);var r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),a.prototype.readBigInt64BE=Q((function(e){F(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Y(e,this.length-8);var r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),a.prototype.readFloatLE=function(e,t){return e>>>=0,t||O(e,4,this.length),n.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||O(e,4,this.length),n.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||O(e,8,this.length),n.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||O(e,8,this.length),n.read(this,e,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||x(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||x(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeBigUInt64LE=Q((function(e){return P(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),a.prototype.writeBigUInt64BE=Q((function(e){return R(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),a.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);x(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+n},a.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);x(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+n},a.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeBigInt64LE=Q((function(e){return P(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),a.prototype.writeBigInt64BE=Q((function(e){return R(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),a.prototype.writeFloatLE=function(e,t,n){return N(this,e,t,!0,n)},a.prototype.writeFloatBE=function(e,t,n){return N(this,e,t,!1,n)},a.prototype.writeDoubleLE=function(e,t,n){return U(this,e,t,!0,n)},a.prototype.writeDoubleBE=function(e,t,n){return U(this,e,t,!1,n)},a.prototype.copy=function(e,t,n,r){if(!a.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},a.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var i=e.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=a.isBuffer(e)?e:a.from(e,r),l=s.length;if(0===l)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-t;++o)this[o+t]=s[o%l]}return this};var M={};function H(e,t,n){M[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name="".concat(this.name," [").concat(e,"]"),this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}}}function j(e){for(var t="",n=e.length,r="-"===e[0]?1:0;n>=r+4;n-=3)t="_".concat(e.slice(n-3,n)).concat(t);return"".concat(e.slice(0,n)).concat(t)}function D(e,t,n,r,i,o){if(e>n||e<t){var a,s="bigint"==typeof t?"n":"";throw a=o>3?0===t||t===BigInt(0)?">= 0".concat(s," and < 2").concat(s," ** ").concat(8*(o+1)).concat(s):">= -(2".concat(s," ** ").concat(8*(o+1)-1).concat(s,") and < 2 ** ").concat(8*(o+1)-1).concat(s):">= ".concat(t).concat(s," and <= ").concat(n).concat(s),new M.ERR_OUT_OF_RANGE("value",a,e)}!function(e,t,n){F(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||Y(t,e.length-(n+1))}(r,i,o)}function F(e,t){if("number"!=typeof e)throw new M.ERR_INVALID_ARG_TYPE(t,"number",e)}function Y(e,t,n){if(Math.floor(e)!==e)throw F(e,n),new M.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new M.ERR_BUFFER_OUT_OF_BOUNDS;throw new M.ERR_OUT_OF_RANGE(n||"offset",">= ".concat(n?1:0," and <= ").concat(t),e)}H("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?"".concat(e," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"}),RangeError),H("ERR_INVALID_ARG_TYPE",(function(e,t){return'The "'.concat(e,'" argument must be of type number. Received type ').concat(typeof t)}),TypeError),H("ERR_OUT_OF_RANGE",(function(e,t,n){var r='The value of "'.concat(e,'" is out of range.'),i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=j(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=j(i)),i+="n"),r+=" It must be ".concat(t,". Received ").concat(i)}),RangeError);var W=/[^+/0-9A-Za-z-_]/g;function G(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function q(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,r){var i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function $(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function K(e){return e!=e}var X=function(){for(var e="0123456789abcdef",t=new Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)t[r+i]=e[n]+e[i];return t}();function Q(e){return"undefined"==typeof BigInt?z:e}function z(){throw new Error("BigInt not supported")}}});init_modules_watch_stub(),init_modules_watch_stub(),init_modules_watch_stub();var import_sha224=__toESM(require_sha224()),import_enc_hex=__toESM(require_enc_hex());init_modules_watch_stub(),init_modules_watch_stub(),init_modules_watch_stub(),init_modules_watch_stub();var regex_default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function validate(e){return"string"==typeof e&&regex_default.test(e)}for(var validate_default=validate,byteToHex=[],_i15=0;_i15<256;++_i15)byteToHex.push((_i15+256).toString(16).slice(1));function unsafeStringify(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return byteToHex[e[t+0]]+byteToHex[e[t+1]]+byteToHex[e[t+2]]+byteToHex[e[t+3]]+"-"+byteToHex[e[t+4]]+byteToHex[e[t+5]]+"-"+byteToHex[e[t+6]]+byteToHex[e[t+7]]+"-"+byteToHex[e[t+8]]+byteToHex[e[t+9]]+"-"+byteToHex[e[t+10]]+byteToHex[e[t+11]]+byteToHex[e[t+12]]+byteToHex[e[t+13]]+byteToHex[e[t+14]]+byteToHex[e[t+15]]}function parse(e){if(!validate_default(e))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n}init_modules_watch_stub(),init_modules_watch_stub();var parse_default=parse;function stringToBytes(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}var DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",URL2="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function v35(e,t,n){function r(e,r,i,o){var a;if("string"==typeof e&&(e=stringToBytes(e)),"string"==typeof r&&(r=parse_default(r)),16!==(null===(a=r)||void 0===a?void 0:a.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+e.length);if(s.set(r),s.set(e,r.length),(s=n(s))[6]=15&s[6]|t,s[8]=63&s[8]|128,i){o=o||0;for(var l=0;l<16;++l)i[o+l]=s[l];return i}return unsafeStringify(s)}try{r.name=e}catch(e){}return r.DNS=DNS,r.URL=URL2,r}function f(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:case 3:return t^n^r;case 2:return t&n^t&r^n&r}}function ROTL(e,t){return e<<t|e>>>32-t}function sha1(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var r=unescape(encodeURIComponent(e));e=[];for(var i=0;i<r.length;++i)e.push(r.charCodeAt(i))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var o=e.length/4+2,a=Math.ceil(o/16),s=new Array(a),l=0;l<a;++l){for(var c=new Uint32Array(16),u=0;u<16;++u)c[u]=e[64*l+4*u]<<24|e[64*l+4*u+1]<<16|e[64*l+4*u+2]<<8|e[64*l+4*u+3];s[l]=c}s[a-1][14]=8*(e.length-1)/Math.pow(2,32),s[a-1][14]=Math.floor(s[a-1][14]),s[a-1][15]=8*(e.length-1)&4294967295;for(var p=0;p<a;++p){for(var d=new Uint32Array(80),h=0;h<16;++h)d[h]=s[p][h];for(var g=16;g<80;++g)d[g]=ROTL(d[g-3]^d[g-8]^d[g-14]^d[g-16],1);for(var m=n[0],y=n[1],v=n[2],b=n[3],_=n[4],w=0;w<80;++w){var E=Math.floor(w/20),A=ROTL(m,5)+f(E,y,v,b)+_+t[E]+d[w]>>>0;_=b,b=v,v=ROTL(y,30)>>>0,y=m,m=A}n[0]=n[0]+m>>>0,n[1]=n[1]+y>>>0,n[2]=n[2]+v>>>0,n[3]=n[3]+b>>>0,n[4]=n[4]+_>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]}init_modules_watch_stub(),init_modules_watch_stub();var sha1_default=sha1,v5=v35("v5",80,sha1_default),v5_default=v5;init_modules_watch_stub();var version="2.4",providersUri="https://raw.githubusercontent.com/vfarid/v2ray-worker/main/resources/provider-list.txt",proxiesUri="https://raw.githubusercontent.com/vfarid/v2ray-worker/main/resources/proxy-list.txt",defaultProtocols=["vmess","built-in-vless","vless","built-in-trojan"],defaultALPNList=["h3,h2,http/1.1","h3,h2,http/1.1","h3,h2,http/1.1","h3,h2","h2,http/1.1","h2","http/1.1"],defaultPFList=["chrome","firefox","randomized","safari","chrome","edge","randomized","ios","chrome","android","randomized"],cfPorts=[443,2053,2083,2087,2096,8443],fragmentsLengthList=["10-20","10-50","20-50","30-80","50-100"],fragmentsIntervalList=["10-20","10-50","20-50"],defaultClashConfig={port:7890,"socks-port":7891,"allow-lan":!1,mode:"rule","log-level":"info","external-controller":"127.0.0.1:9090",dns:{enable:!0,ipv6:!1,"enhanced-mode":"fake-ip",nameserver:["114.114.114.114","223.5.5.5","8.8.8.8","9.9.9.9","1.1.1.1","https://dns.google/dns-query","tls://dns.google:853"]},proxies:[],"proxy-groups":[],rules:["GEOIP,IR,DIRECT","DOMAIN-SUFFIX,ir,DIRECT","IP-CIDR,127.0.0.0/8,DIRECT","IP-CIDR,192.168.0.0/16,DIRECT","IP-CIDR,172.16.0.0/12,DIRECT","IP-CIDR,10.0.0.0/8,DIRECT","MATCH,All"]};function GetMultipleRandomElements(e,t){return e.sort((()=>.5-Math.random())).slice(0,t)}function IsIp(e){try{if(""==e||null==e)return!1;if(!/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])(\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])){2}\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-4])$/.test(e))return!1;var t=e.split(".");return null!=t&&4==t.length&&"0"!=t[3]&&0!==parseInt(t[3])}catch(e){}return!1}function IsValidUUID(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)}function GetVlessConfig(e,t,n,r,i){return r.toLowerCase()==n.toLowerCase()&&(r=n),{remarks:"".concat(e,"-vless-worker-").concat(r),configType:"vless",security:"tls",tls:"tls",network:"ws",port:i,sni:n,uuid:t,host:n,path:"vless-ws/?ed=2048",address:r}}function GetTrojanConfig(e,t,n,r,i){return r.toLowerCase()==n.toLowerCase()&&(r=n),{remarks:"".concat(e,"-trojan-worker-").concat(r),configType:"trojan",security:"tls",tls:"tls",network:"ws",port:i,sni:n,password:t,host:n,path:"trojan-ws/?ed=2048",address:r}}function IsBase64(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$/.test(e)}function RemoveDuplicateConfigs(e){var t={};return e.filter((e=>{var n=e.remarks+e.port+e.address+e.uuid;return!t[n]&&(t[n]=!0,!0)}))}function AddNumberToConfigs(e,t){return e.map(((e,n)=>(e.remarks=n+t+"-"+e.remarks,e)))}function GenerateToken(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,t=new Uint8Array(e),n=0;n<e;n++)t[n]=Math.floor(256*Math.random());return Array.from(t).map((e=>e.toString(16).padStart(2,"0"))).join("")}function Delay(e){return new Promise((t=>setTimeout(t,e)))}function MuddleDomain(e){var t=e.split(".");return t.slice(0,t.length-2).join(".")+"."+t.slice(-2).join(".").split("").map((e=>Math.random()<.5?e.toLowerCase():e.toUpperCase())).join("")}function getUUID(e){return v5_default(e.toLowerCase(),"ebc4a168-a6fe-47ce-bc25-6183c6212dcc")}function getSHA224Password(e){return(0,import_sha224.default)(e.toLowerCase()).toString(import_enc_hex.default)}var WS_READY_STATE_OPEN=1,WS_READY_STATE_CLOSING=2,proxyIP="",proxyList=[],blockPorn="",filterCountries="",countries=[];function GetVlessConfigList(e,t,n,r,i){return _GetVlessConfigList.apply(this,arguments)}function _GetVlessConfigList(){return(_GetVlessConfigList=_asyncToGenerator((function*(e,t,n,r,i){filterCountries="",blockPorn="",proxyList=[];for(var o=getUUID(e),a=[],s=0;s<r;s++)a.push(GetVlessConfig(s+n,o,MuddleDomain(e),t[Math.floor(Math.random()*t.length)],cfPorts[Math.floor(Math.random()*cfPorts.length)]));return a}))).apply(this,arguments)}function VlessOverWSHandler(e,t,n){return _VlessOverWSHandler.apply(this,arguments)}function _VlessOverWSHandler(){return(_VlessOverWSHandler=_asyncToGenerator((function*(e,t,n){var r=getUUID(t),[i,o]=Object.values(new WebSocketPair);o.accept();var a=e.headers.get("sec-websocket-protocol")||"",s=MakeReadableWebSocketStream(o,a),l={value:null},c=null,u=!1;return s.pipeTo(new WritableStream({write:(e,t)=>_asyncToGenerator((function*(){if(u&&c)return c(e);if(l.value){var t=l.value.writable.getWriter();return yield t.write(e),void t.releaseLock()}var{hasError:i,message:a,addressRemote:s="",addressType:p,portRemote:d=443,rawDataIndex:f,vlessVersion:h=new Uint8Array([0,0]),isUDP:g,isMUX:m}=ProcessVlessHeader(e,r);if(i)throw new Error(a);if(g){if(53!==d)throw new Error("UDP proxy only enable for DNS which is port 53");u=!0}else if(m)throw new Error("MUX is not supported!");var y=new Uint8Array([h[0],0]),v=e.slice(f);if(u){var{write:b}=yield HandleUDPOutbound(o,y,n);(c=b)(v)}else HandleTCPOutbound(l,s,d,v,o,y,n)}))()})).catch((e=>{})),new Response(null,{status:101,webSocket:i})}))).apply(this,arguments)}function MakeReadableWebSocketStream(e,t){var n=!1;return new ReadableStream({start(r){e.addEventListener("message",(e=>{if(!n){var t=e.data;r.enqueue(t)}})),e.addEventListener("close",(()=>{SafeCloseWebSocket(e),n||r.close()})),e.addEventListener("error",(e=>{r.error(e)}));var{earlyData:i,error:o}=Base64ToArrayBuffer(t);o?r.error(o):i&&r.enqueue(i)},cancel(t){n||(n=!0,SafeCloseWebSocket(e))}})}function ProcessVlessHeader(e,t){if(e.byteLength<24)return{hasError:!0,message:"Invalid data"};var n=new Uint8Array(e.slice(0,1)),r=!1,i=!1,o=!1;if(Stringify(new Uint8Array(e.slice(1,17)))===t&&(r=!0),!r)return{hasError:!0,message:"Invalid user"};var a=new Uint8Array(e.slice(17,18))[0],s=new Uint8Array(e.slice(18+a,18+a+1))[0];if(1===s);else if(2===s)i=!0;else{if(3!==s)return{hasError:!0,message:"Command ".concat(s," is not support, command 01-tcp, 02-udp, 03-mux")};o=!0}var l=18+a+1,c=e.slice(l,l+2),u=new DataView(c).getUint16(0),p=l+2,d=new Uint8Array(e.slice(p,p+1))[0],f=0,h=p+1,g="";switch(d){case 1:f=4,g=new Uint8Array(e.slice(h,h+f)).join(".");break;case 2:f=new Uint8Array(e.slice(h,h+1))[0],h+=1,g=(new TextDecoder).decode(e.slice(h,h+f));break;case 3:f=16;for(var m=new DataView(e.slice(h,h+f)),y=[],v=0;v<8;v++)y.push(m.getUint16(2*v).toString(16));g=y.join(":");break;default:return{hasError:!0,message:"invild  addressType is ".concat(d)}}return g?{hasError:!1,addressRemote:g,addressType:d,portRemote:u,rawDataIndex:h+f,vlessVersion:n,isUDP:i,isMUX:o}:{hasError:!0,message:"addressValue is empty, addressType is ".concat(d)}}function HandleUDPOutbound(e,t,n){return _HandleUDPOutbound.apply(this,arguments)}function _HandleUDPOutbound(){return(_HandleUDPOutbound=_asyncToGenerator((function*(e,t,n){var r=!1,i=new TransformStream({transform(e,t){for(var n=0;n<e.byteLength;){var r=e.slice(n,n+2),i=new DataView(r).getUint16(0),o=new Uint8Array(e.slice(n+2,n+2+i));n=n+2+i,t.enqueue(o)}}});""==blockPorn&&(blockPorn=(yield n.settings.get("BlockPorn"))||"no"),i.readable.pipeTo(new WritableStream({write:n=>_asyncToGenerator((function*(){var i=yield fetch("yes"==blockPorn?"https://1.1.1.3/dns-query":"https://1.1.1.1/dns-query",{method:"POST",headers:{"content-type":"application/dns-message"},body:n}),o=yield i.arrayBuffer(),a=o.byteLength,s=new Uint8Array([a>>8&255,255&a]);e.readyState===WS_READY_STATE_OPEN&&(r?e.send(yield new Blob([s,o]).arrayBuffer()):(e.send(yield new Blob([t,s,o]).arrayBuffer()),r=!0))}))()})).catch((e=>{}));var o=i.writable.getWriter();return{write(e){o.write(e)}}}))).apply(this,arguments)}function HandleTCPOutbound(e,t,n,r,i,o,a){return _HandleTCPOutbound.apply(this,arguments)}function _HandleTCPOutbound(){return _HandleTCPOutbound=_asyncToGenerator((function*(e,t,n,r,i,o,a){var s=0;function l(e,t){return c.apply(this,arguments)}function c(){return(c=_asyncToGenerator((function*(t,n){var i={hostname:t,port:n},o=(0,_cloudflareSockets.connect)(i,{allowHalfOpen:!1});e.value=o;var a=o.writable.getWriter();return yield a.write(r),a.releaseLock(),o}))).apply(this,arguments)}function u(){return p.apply(this,arguments)}function p(){return(p=_asyncToGenerator((function*(){if(!(++s>5)){var e;if(!proxyList.length)countries=(null===(e=yield a.settings.get("Countries"))||void 0===e?void 0:e.split(",").filter((e=>e.trim().length>0)))||[],proxyList=yield fetch(proxiesUri).then((e=>e.text())).then((e=>e.trim().split("\n").filter((e=>e.trim().length>0)))),countries.length>0&&(proxyList=proxyList.filter((e=>{var t=e.split(",");if(t.length>0)return countries.includes(t[1])}))),proxyList=proxyList.map((e=>e.split(",")[0])),console.log(proxyList);if(proxyList.length>0)proxyIP=proxyList[Math.floor(Math.random()*proxyList.length)],RemoteSocketToWS(yield l(proxyIP,n),i,o,u)}}))).apply(this,arguments)}RemoteSocketToWS(yield l(t,n),i,o,u)})),_HandleTCPOutbound.apply(this,arguments)}function RemoteSocketToWS(e,t,n,r){return _RemoteSocketToWS.apply(this,arguments)}function _RemoteSocketToWS(){return(_RemoteSocketToWS=_asyncToGenerator((function*(e,t,n,r){var i=n,o=!1;yield e.readable.pipeTo(new WritableStream({write:(e,n)=>_asyncToGenerator((function*(){try{o=!0,t.readyState!==WS_READY_STATE_OPEN&&n.error("webSocket.readyState is not open, maybe close"),i?(t.send(yield new Blob([i,e]).arrayBuffer()),i=null):t.send(e)}catch(e){}}))(),abort(e){}})).catch((e=>{SafeCloseWebSocket(t)})),!1===o&&r&&r()}))).apply(this,arguments)}function SafeCloseWebSocket(e){try{e.readyState!==WS_READY_STATE_OPEN&&e.readyState!==WS_READY_STATE_CLOSING||e.close()}catch(e){}}function Base64ToArrayBuffer(e){if(!e)return{earlyData:null,error:null};try{e=e.replace(/-/g,"+").replace(/_/g,"/");var t=atob(e);return{earlyData:Uint8Array.from(t,(e=>e.charCodeAt(0))).buffer,error:null}}catch(e){return{earlyData:null,error:e}}}function IsValidVlessUUID(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function Stringify(e){var t=UnsafeStringify(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0);if(!IsValidVlessUUID(t))throw TypeError("Stringified UUID is invalid");return t}for(var byteToHex2=[],_i23=0;_i23<256;++_i23)byteToHex2.push((_i23+256).toString(16).slice(1));function UnsafeStringify(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(byteToHex2[e[t+0]]+byteToHex2[e[t+1]]+byteToHex2[e[t+2]]+byteToHex2[e[t+3]],"-").concat(byteToHex2[e[t+4]]+byteToHex2[e[t+5]],"-").concat(byteToHex2[e[t+6]]+byteToHex2[e[t+7]],"-").concat(byteToHex2[e[t+8]]+byteToHex2[e[t+9]],"-").concat(byteToHex2[e[t+10]]+byteToHex2[e[t+11]]+byteToHex2[e[t+12]]+byteToHex2[e[t+13]]+byteToHex2[e[t+14]]+byteToHex2[e[t+15]]).toLowerCase()}init_modules_watch_stub();var WS_READY_STATE_OPEN2=1,WS_READY_STATE_CLOSING2=2,proxyIP2="",proxyList2=[],filterCountries2="",countries2=[];function GetTrojanConfigList(e,t,n,r,i){return _GetTrojanConfigList.apply(this,arguments)}function _GetTrojanConfigList(){return(_GetTrojanConfigList=_asyncToGenerator((function*(e,t,n,r,i){filterCountries2="",proxyList2=[];for(var o=[],a=0;a<r;a++)o.push(GetTrojanConfig(a+n,getUUID(e),MuddleDomain(e),t[Math.floor(Math.random()*t.length)],cfPorts[Math.floor(Math.random()*cfPorts.length)]));return o}))).apply(this,arguments)}function TrojanOverWSHandler(e,t,n){return _TrojanOverWSHandler.apply(this,arguments)}function _TrojanOverWSHandler(){return(_TrojanOverWSHandler=_asyncToGenerator((function*(e,t,n){var r=getSHA224Password(getUUID(t)),[i,o]=Object.values(new WebSocketPair);o.accept();var a=e.headers.get("sec-websocket-protocol")||"",s=MakeReadableWebSocketStream2(o,a),l={value:null};return s.pipeTo(new WritableStream({write:(e,t)=>_asyncToGenerator((function*(){if(l.value){var t=l.value.writable.getWriter();return yield t.write(e),void t.releaseLock()}var{hasError:i,message:a,portRemote:s=443,addressRemote:c="",rawClientData:u}=yield ParseTrojanHeader(e,r);if(i)throw new Error(a);HandleTCPOutbound2(l,c,s,u,o,n)}))()})).catch((e=>{})),new Response(null,{status:101,webSocket:i})}))).apply(this,arguments)}function ParseTrojanHeader(e,t){return _ParseTrojanHeader.apply(this,arguments)}function _ParseTrojanHeader(){return(_ParseTrojanHeader=_asyncToGenerator((function*(e,t){if(e.byteLength<56)return{hasError:!0,message:"invalid data"};if(13!==new Uint8Array(e.slice(56,57))[0]||10!==new Uint8Array(e.slice(57,58))[0])return{hasError:!0,message:"invalid header format (missing CR LF)"};if((new TextDecoder).decode(e.slice(0,56))!==t)return{hasError:!0,message:"invalid password"};var n=e.slice(58);if(n.byteLength<6)return{hasError:!0,message:"invalid SOCKS5 request data"};var r=new DataView(n);if(1!==r.getUint8(0))return{hasError:!0,message:"unsupported command, only TCP (CONNECT) is allowed"};var i=r.getUint8(1),o=0,a=2,s="";switch(i){case 1:o=4,s=new Uint8Array(n.slice(a,a+o)).join(".");break;case 3:o=new Uint8Array(n.slice(a,a+1))[0],a+=1,s=(new TextDecoder).decode(n.slice(a,a+o));break;case 4:o=16;for(var l=new DataView(n.slice(a,a+o)),c=[],u=0;u<8;u++)c.push(l.getUint16(2*u).toString(16));s=c.join(":");break;default:return{hasError:!0,message:"invalid addressType is ".concat(i)}}if(!s)return{hasError:!0,message:"address is empty, addressType is ".concat(i)};var p=a+o,d=n.slice(p,p+2);return{hasError:!1,addressRemote:s,portRemote:new DataView(d).getUint16(0),rawClientData:n.slice(p+4)}}))).apply(this,arguments)}function HandleTCPOutbound2(e,t,n,r,i,o){return _HandleTCPOutbound2.apply(this,arguments)}function _HandleTCPOutbound2(){return _HandleTCPOutbound2=_asyncToGenerator((function*(e,t,n,r,i,o){var a=0;function s(e,t){return l.apply(this,arguments)}function l(){return(l=_asyncToGenerator((function*(t,n){var i={hostname:t,port:n},o=(0,_cloudflareSockets.connect)(i);e.value=o;var a=o.writable.getWriter();return yield a.write(r),a.releaseLock(),o}))).apply(this,arguments)}function c(){return u.apply(this,arguments)}function u(){return(u=_asyncToGenerator((function*(){if(!(++a>5)){var e;if(!proxyList2.length)countries2=(null===(e=yield o.settings.get("Countries"))||void 0===e?void 0:e.split(",").filter((e=>e.trim().length>0)))||[],proxyList2=yield fetch(proxiesUri).then((e=>e.text())).then((e=>e.trim().split("\n").filter((e=>e.trim().length>0)))),countries2.length>0&&(proxyList2=proxyList2.filter((e=>{var t=e.split(",");if(t.length>0)return countries2.includes(t[1])}))),proxyList2=proxyList2.map((e=>e.split(",")[0]));if(proxyList2.length>0)proxyIP2=proxyList2[Math.floor(Math.random()*proxyList2.length)],RemoteSocketToWS2(yield s(proxyIP2,n),i,c)}}))).apply(this,arguments)}RemoteSocketToWS2(yield s(t,n),i,c)})),_HandleTCPOutbound2.apply(this,arguments)}function MakeReadableWebSocketStream2(e,t){var n=!1;return new ReadableStream({start(r){e.addEventListener("message",(e=>{if(!n){var t=e.data;r.enqueue(t)}})),e.addEventListener("close",(()=>{SafeCloseWebSocket2(e),n||r.close()})),e.addEventListener("error",(e=>{r.error(e)}));var{earlyData:i,error:o}=Base64ToArrayBuffer2(t);o?r.error(o):i&&r.enqueue(i)},pull(e){},cancel(t){n||(n=!0,SafeCloseWebSocket2(e))}})}function RemoteSocketToWS2(e,t,n){return _RemoteSocketToWS2.apply(this,arguments)}function _RemoteSocketToWS2(){return(_RemoteSocketToWS2=_asyncToGenerator((function*(e,t,n){var r=!1;yield e.readable.pipeTo(new WritableStream({write:(e,n)=>_asyncToGenerator((function*(){try{r=!0,t.readyState!==WS_READY_STATE_OPEN2&&n.error("webSocket.readyState is not open, maybe close"),t.send(e)}catch(e){}}))(),abort(e){}})).catch((e=>{SafeCloseWebSocket2(t)})),!1===r&&n&&n()}))).apply(this,arguments)}function Base64ToArrayBuffer2(e){if(!e)return{earlyData:null,error:null};try{e=e.replace(/-/g,"+").replace(/_/g,"/");var t=atob(e);return{earlyData:Uint8Array.from(t,(e=>e.charCodeAt(0))).buffer,error:null}}catch(e){return{earlyData:null,error:e}}}function SafeCloseWebSocket2(e){try{e.readyState!==WS_READY_STATE_OPEN2&&e.readyState!==WS_READY_STATE_CLOSING2||e.close()}catch(e){}}init_modules_watch_stub();var bcrypt=__toESM(require_bcrypt());function GetPanel(e,t){return _GetPanel.apply(this,arguments)}function _GetPanel(){return(_GetPanel=_asyncToGenerator((function*(e,t){var n=new URL(e.url);try{var r,i,o,a,s,l,c,u=yield t.settings.get("Password"),p=yield t.settings.get("Token");if(u&&n.searchParams.get("token")!=p)return Response.redirect("".concat(n.origin,"/login"),302);((yield t.settings.get("Version"))||"2.0")!=version&&(yield t.settings.delete("Providers"),yield t.settings.delete("Protocols"));var d=parseInt((yield t.settings.get("MaxConfigs"))||"200"),f=(null===(r=yield t.settings.get("Protocols"))||void 0===r?void 0:r.split("\n").filter((e=>e.trim().length>0)))||defaultProtocols,h=(null===(i=yield t.settings.get("ALPNs"))||void 0===i?void 0:i.split("\n").filter((e=>e.trim().length>0)))||[],g=(null===(o=yield t.settings.get("FingerPrints"))||void 0===o?void 0:o.split("\n").filter((e=>e.trim().length>0)))||[],m=(null===(a=yield t.settings.get("CleanDomainIPs"))||void 0===a?void 0:a.split("\n").filter((e=>e.trim().length>0)))||[],y=(null===(s=yield t.settings.get("Configs"))||void 0===s?void 0:s.split("\n").filter((e=>e.trim().length>0)))||[],v=(yield t.settings.get("IncludeOriginalConfigs"))||"yes",b=(yield t.settings.get("IncludeMergedConfigs"))||"yes",_=(yield t.settings.get("EnableFragments"))||"no",w=(yield t.settings.get("BlockPorn"))||"no",E=(null===(l=yield t.settings.get("Providers"))||void 0===l?void 0:l.split("\n").filter((e=>e.trim().length>0)))||[],A=(null===(c=yield t.settings.get("Countries"))||void 0===c?void 0:c.split(",").filter((e=>e.trim().length>0)))||[],S=yield fetch(proxiesUri).then((e=>e.text())).then((e=>e.trim().split("\n").map((e=>{var t,n=e.split(",");return n.length>0?null===(t=n[1])||void 0===t?void 0:t.toString().trim().toUpperCase():""})).filter((e=>e))));S=[...new Set(S)].sort();var T="",k=n.searchParams.get("message");"success"==k?T='<div class="p-1 bg-success text-white fw-bold text-center">Settings saved successfully.<br/>    .</div>':"error"==k&&(T='<div class="p-1 bg-danger text-white fw-bold text-center">Failed to save settings!<br/>   !</div>');var C="";C=u?'\n      <div class="mb-3 p-1">\n        <button type="submit" name="reset_password" value="1" class="btn btn-danger">Remove Password /   </button>\n      </div>\n      ':'\n      <div class="mb-1 p-1 pb-0 pt-3 mt-3 border-top border-primary border-4">\n        <label for="configs" class="form-label fw-bold"> Security&nbsp;</label>\n      </div>\n      <div class="mb-3 p-3 border rounded">\n        <label for="password" class="form-label fw-bold">\n          Enter password, if you want to protect panel /             :\n        </label>\n        <input type="password" name="password" class="form-control" id="password" minlength="6"/>\n        <div class="form-text">\n          Minimum 6 chars /     .\n        </div>\n        <p></p>\n        <label for="password-confirmation" class="form-label fw-bold">\n          Confirm your password /      :\n        </label>\n        <input type="password" name="password_confirmation" class="form-control" id="password-confirmation" minlength="6"/>\n      </div>\n      ';var I='\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <meta charset="utf8" />\n      <link rel="shortcut icon" type="image/ico" href="https://dash.cloudflare.com/favicon.ico" />\n      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous" rel="stylesheet" />\n      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"><\/script>\n      <script>\n        let language = localStorage.getItem("lang") || "fa"\n        window.addEventListener("load", (event) => {\n          initLang();\n          setLang(language);\n\n          document.getElementById(\'providers-check\').addEventListener("change", () => {\n            if (document.getElementById(\'providers-check\').checked) {\n              document.getElementById(\'providers\').style.display = ""\n              document.getElementById(\'providers-remarks\').style.display = ""\n              document.getElementById(\'providers-auto-title\').style.display = "none"\n            } else {\n              document.getElementById(\'providers\').style.display = "none"\n              document.getElementById(\'providers-remarks\').style.display = "none"\n              document.getElementById(\'providers-auto-title\').style.display = ""\n            }\n          });\n          document.getElementById(\'providers-check\').dispatchEvent(new Event("change"));\n\n          document.getElementById(\'countries-check\').addEventListener("change", () => {\n            if (document.getElementById(\'countries-check\').checked) {\n              document.getElementById(\'countries-div\').style.display = ""\n            } else {\n              document.getElementById(\'countries-div\').style.display = "none"\n            }\n          });\n          document.getElementById(\'countries-check\').dispatchEvent(new Event("change"));\n\n          document.getElementById(\'clean-ips-check\').addEventListener("change", () => {\n            if (document.getElementById(\'clean-ips-check\').checked) {\n              document.getElementById(\'clean-ips\').style.display = ""\n              document.getElementById(\'clean-ips-remarks\').style.display = ""\n            } else {\n              document.getElementById(\'clean-ips\').style.display = "none"\n              document.getElementById(\'clean-ips-remarks\').style.display = "none"\n            }\n          });\n          document.getElementById(\'clean-ips-check\').dispatchEvent(new Event("change"));\n\n          document.getElementById(\'configs-check\').addEventListener("change", () => {\n            if (document.getElementById(\'configs-check\').checked) {\n              document.getElementById(\'configs\').style.display = ""\n              document.getElementById(\'personal-configs-remarks\').style.display = ""\n            } else {\n              document.getElementById(\'configs\').style.display = "none"\n              document.getElementById(\'personal-configs-remarks\').style.display = "none"\n            }\n          });\n          document.getElementById(\'configs-check\').dispatchEvent(new Event("change"));\n\n          document.getElementById(\'fp-list-check\').addEventListener("change", () => {\n            if (document.getElementById(\'fp-list-check\').checked) {\n              document.getElementById(\'fp-list\').style.display = ""\n              document.getElementById(\'fp-list-remarks\').style.display = ""\n            } else {\n              document.getElementById(\'fp-list\').style.display = "none"\n              document.getElementById(\'fp-list-remarks\').style.display = "none"\n            }\n          });\n          document.getElementById(\'fp-list-check\').dispatchEvent(new Event("change"));\n\n          document.getElementById(\'alpn-list-check\').addEventListener("change", () => {\n            if (document.getElementById(\'alpn-list-check\').checked) {\n              document.getElementById(\'alpn-list\').style.display = ""\n              document.getElementById(\'alpn-list-remarks\').style.display = ""\n            } else {\n              document.getElementById(\'alpn-list\').style.display = "none"\n              document.getElementById(\'alpn-list-remarks\').style.display = "none"\n            }\n          });\n          document.getElementById(\'alpn-list-check\').dispatchEvent(new Event("change"));\n        });\n        window.addEventListener(\'message\', function (event) {\n          if (event.data?.cleanIPs) {\n            document.getElementById(\'clean-ips\').value = event.data.cleanIPs;\n          }\n        });\n    \n        function initLang() {\n          document.getElementById("lang-group").innerHTML = ""\n          for (code in strings) {\n            const el = document.createElement("button")\n            el.classList = "btn btn-outline-primary btn-sm rounded-2"\n            el.id = `btn-${code}`\n            el.type = "button"\n            el.innerText = code.toUpperCase()\n            el.setAttribute("data-lang", code);\n            el.addEventListener("click", (e) => {\n                setLang(e.srcElement.getAttribute("data-lang"))\n            })\n            document.getElementById("lang-group").appendChild(el)\n    \n            const el2 = document.createElement("span")\n            el2.innerHTML = "&nbsp;"\n            document.getElementById("lang-group").appendChild(el2)\n          }\n        }\n      \n        function setLang(code) {\n          if (strings[code] === undefined) {\n            code = "en"\n          }\n          \n          document.getElementById(\'body\').style.direction = languages[code]?.dir || "ltr"\n          document.getElementById(\'lang-group\').style.float = languages[code]?.end || "left"\n          document.getElementById(\'btn-\' + language).classList.remove(\'btn-primary\')\n          document.getElementById(\'btn-\' + language).classList.add(\'btn-outline-primary\')\n          document.getElementById(\'btn-\' + code).classList.remove(\'btn-outline-primary\')\n          document.getElementById(\'btn-\' + code).classList.add(\'btn-primary\')\n          \n          for (key in strings[code]) {\n            document.getElementById(key).innerText = strings[code][key]\n          }\n      \n          language = code\n          localStorage.setItem(\'lang\', code);\n        }\n    \n        const languages = {\n          en: {dir: "ltr", end: "right"},\n          fa: {dir: "rtl", end: "left"},\n        }\n      \n        const strings = {\n          en: {\n            "page-title": "V2ray Worker Control Panel",\n            "text-version": "Version",\n            "sub-link-title": "Your subscription link for v2ray clients (v2rayN, v2rayNG, v2rayA, Nekobox, Nekoray, V2Box...)",\n            // "custom-link-title": "Your subscription link for custom configs",\n            "clash-link-title": "Your subscription link for clash clients (Clash, ClashX, ClashMeta...)",\n            "includes-title": "Merged and original configs",\n            "include-merged-configs-title": "Include configs merged with worker",\n            "include-original-configs-title": "Include original configs",\n            "max-configs-title": "Max. mumber of configs",\n            "protocols-title": "Protocols",\n            "clean-ips-title": "Clean IP or clean subdomain",\n            "clean-ips-remarks": "One IP or subdomain per line.",\n            "clean-ips-btn-title": "Find clean IPs",\n            "clean-ips-btn-close-title": "Close",\n            "alpn-list-title": "ALPN List",\n            "alpn-list-remarks": "One item per line.",\n            "fp-list-title": "Fingerprint List",\n            "fp-list-remarks": "One item per line.",\n            "providers-title": "Config Providers",\n            "providers-auto-title": "Auto load from github",\n            "providers-remarks": "One link per line (base64, yaml, raw).",\n            "countries-title": "Limit By Country (Only for websites beind Cloudflare Network)",\n            "countries-all-title": "If you check this option, all protocols will be deactivated except built-in protocols.",\n            "personal-configs-title": "Private Configs",\n            "personal-configs-remarks": "One config per line.",\n            "block-porn-title": "Block Porn",\n            "block-porn-remarks": "If you check this option, porn websites will be blocked and all protocols will be deactivated except built-in vless protocol.",\n            "enable-fragments-title": "Enable Fragments",\n            "enable-fragments-remarks": "If you check this option, fragments will be enabled for all TLS configs using random values.",\n            "save-button": "Save",\n            "reset-button": "Reset",\n          },\n          fa: {\n            "page-title": "   v2ray",\n            "text-version": "",\n            "sub-link-title": "      v2rayN, v2rayNG, v2rayA, Nekobox, Nekoray, V2Box ...",\n            // "custom-link-title": "      Custom",\n            "clash-link-title": "       Clash, ClashX, ClashMeta ...",\n            "includes-title": "   ",\n            "include-merged-configs-title": "       ",\n            "include-original-configs-title": "    ",\n            "max-configs-title": "  ",\n            "protocols-title": "",\n            "clean-ips-title": "     ",\n            "clean-ips-remarks": "        .",\n            "clean-ips-btn-title": "   ",\n            "clean-ips-btn-close-title": "",\n            "alpn-list-title": " ALPN ",\n            "alpn-list-remarks": "      .",\n            "fp-list-title": " ",\n            "fp-list-remarks": "      .",\n            "providers-title": "  ",\n            "providers-auto-title": "   ",\n            "providers-remarks": "       (base64, yaml, raw).",\n            "countries-title": "   (     )",\n            "countries-all-title": "            .",\n            "personal-configs-title": " ",\n            "personal-configs-remarks": "      .",\n            "block-porn-title": " ",\n            "block-porn-remarks": "            vless      .",\n            "enable-fragments-title": " ",\n            "enable-fragments-remarks": "         TLS     .",\n            "save-button": "",\n            "reset-button": "",\n          },\n        }\n      <\/script>\n    </head>\n    <body id="body" style="--bs-body-font-size: .875rem">\n      <div class="container border mt-3 p-0 border-primary border-2 rounded">\n        <div id="lang-group" class="btn-group m-2" role="group" dir="ltr"></div>\n        <div class="p-2 border-bottom border-primary border-2">\n          <div class="text-nowrap fs-5 fw-bold text-dark">\n            <span id="page-title"></span> &nbsp;&nbsp;<span class="text-nowrap fs-6 text-info"><span id="text-version"></span> '.concat(version,"</span>\n          </div>\n        </div>\n        ").concat(T,'\n        <div class="px-4 py-2 bg-light">\n          <label id="sub-link-title" for="sub-link" class="form-label fw-bold"></label>\n          <input id="sub-link" readonly value="').concat(n.origin,'/sub" class="p-1" style="width: calc(100% - 150px)">\n          <button onclick="let tmp=document.getElementById(\'sub-link\');tmp.select();tmp.setSelectionRange(0,99999);navigator.clipboard.writeText(tmp.value)" class="btn btn-primary p-1 mb-1">Copy</button>\n        </div>\n        <div class="px-4 py-2 bg-light">\n          <label id="clash-link-title" for="clash-link" class="form-label fw-bold"></label>\n          <input id="clash-link" readonly value="').concat(n.origin,'/clash" class="p-1" style="width: calc(100% - 150px)">\n          <button onclick="let tmp=document.getElementById(\'clash-link\');tmp.select();tmp.setSelectionRange(0,99999);navigator.clipboard.writeText(tmp.value)" class="btn btn-primary p-1 mb-1">Copy</button>\n        </div>\n        <form class="px-4 py-4 border-top border-2 border-primary" method="post">\n          <div class="mb-1 p-1">\n            <label id="includes-title" class="form-label fw-bold"></label>\n            <div id="includes">\n              <div>\n                <input type="checkbox" name="merged" value="yes" class="form-check-input" id="merged-ckeck" ').concat("yes"==b?"checked":"",'>\n                <label id="include-merged-configs-title" class="form-check-label" for="merged-ckeck"></label>\n              </div>\n              <div>\n                <input type="checkbox" name="original" value="yes" class="form-check-input" id="original-ckeck" ').concat("yes"==v?"checked":"",'>\n                <label id="include-original-configs-title" class="form-check-label" for="original-ckeck"></label>\n              </div>\n            </div>\n          </div>\n          <div class="mb-1 p-1">\n            <label id="max-configs-title" for="max-configs" class="form-label fw-bold"></label>\n            <input type="number" name="max" class="form-control" id="max-configs" value="').concat(d,'" min="50"/>\n            <div class="form-text"></div>\n          </div>\n          <div class="mb-1 p-1">\n            <label id="protocols-title" class="form-label fw-bold"></label>\n            <div id="type">\n              <div>\n                <input type="checkbox" name="protocols" value="vmess" class="form-check-input" id="vmess-protocol-ckeck" ').concat(f.includes("vmess")?"checked":"",' />\n                <label class="form-check-label" for="vmess-protocol-ckeck">VMESS</label>\n              </div>\n              <div>\n                <input type="checkbox" name="protocols" value="vless" class="form-check-input" id="vless-protocol-ckeck" ').concat(f.includes("vless")?"checked":"",' />\n                <label class="form-check-label" for="vless-protocol-ckeck">VLESS</label>\n              </div>\n              <div>\n                <input type="checkbox" name="protocols" value="built-in-vless" class="form-check-input" id="built-in-vless-protocol-ckeck" ').concat(f.includes("built-in-vless")?"checked":"",' />\n                <label class="form-check-label" for="built-in-vless-protocol-ckeck">Built-in VLESS</label>\n              </div>\n              <div>\n                <input type="checkbox" name="protocols" value="built-in-trojan" class="form-check-input" id="built-in-trojan-protocol-ckeck" ').concat(f.includes("built-in-trojan")?"checked":"",' />\n                <label class="form-check-label" for="built-in-trojan-protocol-ckeck">Built-in Trojan</label>\n              </div>\n            </div>\n          </div>\n          <div class="mb-1 p-1 border-top border-2 border-primary">\n            <input type="checkbox" class="form-check-input" name="clean_ips_check" value="1" id="clean-ips-check" ').concat(m.length?"checked":"",'>\n            <label id="clean-ips-title" for="clean-ips-check" class="form-label fw-bold"></label>\n            <textarea rows="5" name="clean_ips" style="display: none" class="form-control" id="clean-ips">').concat(m.join("\n"),'</textarea>\n            <div id="clean-ips-remarks" style="display: none" class="form-text"></div>\n            <div>\n              <button id="clean-ips-btn-title" type="button" style="display: none" class="btn btn-info" data-bs-toggle="modal" data-bs-target="#ip-scanner-modal"></button>\n              <div class="modal fade" id="ip-scanner-modal" tabindex="-1" aria-labelledby="ip-scanner-modal-label" aria-hidden="true">\n                <div class="modal-dialog modal-xl modal-dialog-scrollable">\n                  <div class="modal-content">\n                    <div class="modal-header">\n                      <button id="clean-ips-btn-close-title" type="button" class="btn btn-sm btn-secondary" data-bs-dismiss="modal"></button>\n                    </div>\n                    <div class="modal-body">\n                      <iframe src="https://vfarid.github.io/cf-ip-scanner/" style="width: 100%; height: 90vh;"></iframe>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              </div>\n          </div>\n          <div class="mb-1 p-1">\n            <input type="checkbox" class="form-check-input" name="enable_fragments" value="yes" id="enable-fragments" ').concat("yes"==_?"checked":"",'>\n            <label id="enable-fragments-title" for="enable-fragments" class="form-label fw-bold"></label>\n            <div id="enable-fragments-remarks" class="form-text"></div>\n          </div>\n          <div class="mb-1 p-1">\n            <input type="checkbox" class="form-check-input" name="countries_check" value="1" id="countries-check" ').concat(A.length?"checked":"",'>\n            <label id="countries-title" for="countries-check" class="form-label fw-bold"></label>\n            <div id="countries-all-title" class="form-text"></div>\n            <div id="countries-div" class="px-4 py-1">\n              ').concat(S.map((e=>'<input type="checkbox" class="form-check-input" id="countries-check-'.concat(e.toLowerCase(),'" name="countries[]" value="').concat(e,'" ').concat(A.length&&A.includes(e)?"checked":"",'> <label for="countries-check-').concat(e.toLowerCase(),'" class="form-label">').concat(e,"</label>"))).join(" &nbsp; &nbsp;"),'\n            </div>\n          </div>\n          <div class="mb-1 p-1">\n            <input type="checkbox" class="form-check-input" name="block_porn" value="yes" id="block-porn" ').concat("yes"==w?"checked":"",'>\n            <label id="block-porn-title" for="block-porn" class="form-label fw-bold"></label>\n            <div id="block-porn-remarks" class="form-text"></div>\n          </div>\n          <div class="mb-1 p-1">\n            <input type="checkbox" class="form-check-input" name="alpn_list_check" value="1" id="alpn-list-check" ').concat(h.length?"checked":"",'>\n            <label id="alpn-list-title" for="alpn-list-check" class="form-label fw-bold"></label>\n            <textarea rows="5" name="alpn_list" style="display: none" class="form-control" id="alpn-list">').concat(h.join("\n"),'</textarea>\n            <div id="alpn-list-remarks" style="display: none" class="form-text"></div>\n          </div>\n          <div class="mb-1 p-1">\n            <input type="checkbox" class="form-check-input" name="fp_list_check" value="1" id="fp-list-check" ').concat(g.length?"checked":"",'>\n            <label id="fp-list-title" for="fp-list-check" class="form-label fw-bold"></label>\n            <textarea rows="5" name="fp_list" style="display: none" class="form-control" id="fp-list">').concat(g.join("\n"),'</textarea>\n            <div id="fp-list-remarks" style="display: none" class="form-text"></div>\n          </div>\n          <div class="mb-1 p-1">\n            <input type="checkbox" class="form-check-input" name="providers_check" value="1" id="providers-check" ').concat(E.length?"checked":"",'>\n            <label id="providers-title" for="providers-check" class="form-label fw-bold"></label> &nbsp; &nbsp;\n            <span id="providers-auto-title" class="text-info"></span>\n            <textarea rows="7" name="providers" style="display: none" class="form-control" id="providers">').concat(E.join("\n"),'</textarea>\n            <div id="providers-remarks"  style="display: none" class="form-text"></div>\n          </div>\n          <div class="mb-1 p-1">\n            <input type="checkbox" class="form-check-input" name="configs_check" value="1" id="configs-check" ').concat(y.length?"checked":"",'>\n            <label id="personal-configs-title" for="configs-check" class="form-label fw-bold"></label>\n            <textarea rows="5" name="configs" style="display: none" class="form-control" id="configs">').concat(y.join("\n"),'</textarea>\n            <div id="personal-configs-remarks" style="display: none" class="form-text"></div>\n          </div>\n          ').concat(C,'\n          <button type="submit" id="save-button" name="save" value="save" class="btn btn-primary"></button>\n          <button type="submit" id="reset-button" name="reset" value="reset" class="btn btn-warning"></button>\n        </form>\n        <div class="p-1 border-top border-2 border-primary">\n          <div class="text-nowrap fs-6">\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" role="img" class="octicon">\n              <g clip-path="url(#clip0_1668_3024)">\n                <path d="M9.52217 6.77143L15.4785 0H14.0671L8.89516 5.87954L4.76437 0H0L6.24656 8.8909L0 15.9918H1.41155L6.87321 9.78279L11.2356 15.9918H16L9.52183 6.77143H9.52217ZM7.58887 8.96923L6.95596 8.0839L1.92015 1.03921H4.0882L8.15216 6.7245L8.78507 7.60983L14.0677 14.9998H11.8997L7.58887 8.96957V8.96923Z" fill="currentColor"></path>\n              </g>\n              <defs>\n                <clipPath id="clip0_1668_3024">\n                  <rect width="16" height="16" fill="white"></rect>\n                </clipPath>\n              </defs>\n            </svg>\n            <a class="link-dark link-offset-2" href="https://twitter.com/vahidfarid" target="_blank">@vahidfarid</a><br/>\n            \n            <svg height="16" aria-hidden="true" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-mark-github v-align-middle color-fg-default">\n              <path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"></path>\n            </svg>\n            <a class="link-dark link-offset-2" href="https://github.com/vfarid" target="_blank">vfarid</a>            </p>\n          </div>\n        </div>\n      </div>\n    </body>\n    </html>\n    ');return new Response(I,{headers:{"Content-Type":"text/html"}})}catch(e){if(e instanceof TypeError){var L='\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <meta charset="utf8" />\n          <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">\n        </head>\n        <body id="body" style="--bs-body-font-size: .875rem">\n          <div class="container border mt-3 p-0 border-primary border-2 rounded">\n            <div id="lang-group" class="btn-group m-2" role="group" dir="ltr"></div>\n            <div class="p-2 border-bottom border-primary border-2">\n              <div class="text-nowrap fs-5 fw-bold text-dark">\n                <span id="page-title"></span> &nbsp;&nbsp;<span class="text-nowrap fs-6 text-info"><span id="text-version"></span> '.concat(version,'</span>\n              </div>\n            </div>\n            <div class="px-5 py-2 bg-light">\n              <label id="sub-link-title" for="sub-link" class="form-label fw-bold"></label>\n              <input id="sub-link" readonly value="').concat(n.origin,'/sub" class="p-1" style="width: calc(100% - 150px)">\n              <button onclick="let tmp=document.getElementById(\'sub-link\');tmp.select();tmp.setSelectionRange(0,99999);navigator.clipboard.writeText(tmp.value)" class="btn btn-primary p-1 mb-1">Copy</button>\n            </div>\n            <div class="px-5 py-2 bg-light">\n              <label id="clash-link-title" for="clash-link" class="form-label fw-bold"></label>\n              <input id="clash-link" readonly value="').concat(n.origin,'/clash" class="p-1" style="width: calc(100% - 150px)">\n              <button onclick="let tmp=document.getElementById(\'clash-link\');tmp.select();tmp.setSelectionRange(0,99999);navigator.clipboard.writeText(tmp.value)" class="btn btn-primary p-1 mb-1">Copy</button>\n            </div>\n            <div id="you-can-use-your-worker-message" class="mx-5 my-2 p-4 border bg-success text-white fw-bold text-center"></div>\n            <div class="mx-5 my-2 p-1 border bg-warning">\n              <div id="you-need-namespace-message"></div>\n              <ol>\n                <li>\n                  <a id="open-kv-text" href="https://dash.cloudflare.com/?to=/:account/workers/kv/namespaces" target="_blank"></a>\n                </li>\n                <li>\n                  <a id="open-variables-text" href="https://dash.cloudflare.com/?to=/:account/workers/services/view/').concat(n.hostname.split(".")[0],'/production/settings/bindings" target="_blank"></a>\n                </li>\n              </ol>\n            </div>\n            <div class="p-1 border-top border-2 border-primary">\n              <div class="text-nowrap fs-6">\n                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" role="img" class="octicon">\n                  <g clip-path="url(#clip0_1668_3024)">\n                    <path d="M9.52217 6.77143L15.4785 0H14.0671L8.89516 5.87954L4.76437 0H0L6.24656 8.8909L0 15.9918H1.41155L6.87321 9.78279L11.2356 15.9918H16L9.52183 6.77143H9.52217ZM7.58887 8.96923L6.95596 8.0839L1.92015 1.03921H4.0882L8.15216 6.7245L8.78507 7.60983L14.0677 14.9998H11.8997L7.58887 8.96957V8.96923Z" fill="currentColor"></path>\n                  </g>\n                  <defs>\n                    <clipPath id="clip0_1668_3024">\n                      <rect width="16" height="16" fill="white"></rect>\n                    </clipPath>\n                  </defs>\n                </svg>\n                <a class="link-dark link-offset-2" href="https://twitter.com/vahidfarid" target="_blank">@vahidfarid</a><br/>\n                \n                <svg height="16" aria-hidden="true" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-mark-github v-align-middle color-fg-default">\n                  <path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"></path>\n                </svg>\n                <a class="link-dark link-offset-2" href="https://github.com/vfarid" target="_blank">vfarid</a>            </p>\n              </div>\n            </div>\n          </div>\n        </body>\n        <script>\n        let language = localStorage.getItem("lang") || "fa"\n        window.addEventListener("load", (event) => {\n          initLang();\n          setLang(language);\n        });\n    \n        function initLang() {\n          document.getElementById("lang-group").innerHTML = ""\n          for (code in strings) {\n            const el = document.createElement("button")\n            el.classList = "btn btn-outline-primary btn-sm rounded-2"\n            el.id = `btn-${code}`\n            el.type = "button"\n            el.innerText = code.toUpperCase()\n            el.setAttribute("data-lang", code);\n            el.addEventListener("click", (e) => {\n                setLang(e.srcElement.getAttribute("data-lang"))\n            })\n            document.getElementById("lang-group").appendChild(el)\n    \n            const el2 = document.createElement("span")\n            el2.innerHTML = "&nbsp;"\n            document.getElementById("lang-group").appendChild(el2)\n          }\n        }\n      \n        function setLang(code) {\n          if (strings[code] === undefined) {\n            code = "en"\n          }\n          \n          document.getElementById(\'body\').style.direction = languages[code]?.dir || "ltr"\n          document.getElementById(\'lang-group\').style.float = languages[code]?.end || "left"\n          document.getElementById(\'btn-\' + language).classList.remove(\'btn-primary\')\n          document.getElementById(\'btn-\' + language).classList.add(\'btn-outline-primary\')\n          document.getElementById(\'btn-\' + code).classList.remove(\'btn-outline-primary\')\n          document.getElementById(\'btn-\' + code).classList.add(\'btn-primary\')\n          \n          for (key in strings[code]) {\n            document.getElementById(key).innerText = strings[code][key]\n          }\n      \n          language = code\n          localStorage.setItem(\'lang\', code);\n        }\n    \n        const languages = {\n          en: {dir: "ltr", end: "right"},\n          fa: {dir: "rtl", end: "left"},\n        }\n      \n        const strings = {\n          en: {\n            "page-title": "V2ray Worker Control Panel",\n            "text-version": "Version",\n            "sub-link-title": "Your subscription link for v2ray clients (v2rayN, v2rayNG, v2rayA, Nekobox, Nekoray, V2Box...)",\n            // "custom-link-title": "Your subscription link for custom configs",\n            "clash-link-title": "Your subscription link for clash clients (Clash, ClashX, ClashMeta...)",\n            "you-can-use-your-worker-message": "You can continue using your worker without control panel.",\n            "you-need-namespace-message": "The \'settings\' namespace is not defined! Please define a namespace named \'settings\' in your worker \'KV Namespace Bindings\' using bellow link, as described in the video and relad the page afterward.",  \n            "open-kv-text": "Open KV",\n            "open-variables-text": "Open Worker\'s Variables",\n          },\n          fa: {\n            "page-title": "   v2ray",\n            "text-version": "",\n            "sub-link-title": "      v2rayN, v2rayNG, v2rayA, Nekobox, Nekoray, V2Box ...",\n            // "custom-link-title": "      Custom",\n            "clash-link-title": "       Clash, ClashX, ClashMeta ...",\n            "you-can-use-your-worker-message": "         .",\n            "you-need-namespace-message": "  settings   .            KV      settings       \'KV Namespace Bindings\'      settings              .",\n            "open-kv-text": "  KV",\n            "open-variables-text": "   ",\n          },\n        }\n        <\/script>\n        </html>\n      ');return new Response(L,{headers:{"Content-Type":"text/html"}})}throw e}}))).apply(this,arguments)}function PostPanel(e,t){return _PostPanel.apply(this,arguments)}function _PostPanel(){return(_PostPanel=_asyncToGenerator((function*(e,t){var n=new URL(e.url),r=yield t.settings.get("Token");try{var i=yield e.formData(),o=yield t.settings.get("Password");if(o&&n.searchParams.get("token")!=r)return Response.redirect("".concat(n.origin,"/login"),302);if(i.get("reset_password"))return yield t.settings.delete("Password"),yield t.settings.delete("Token"),Response.redirect("".concat(n.origin,"?message=success"),302);if(i.get("save")){var a,s,l,c,u,p,d,f,h,g,m,y,v,b,_,w,E,A,S,T=(null===(a=i.get("password"))||void 0===a?void 0:a.toString())||"";if(T){if(T.length<6||T!==i.get("password_confirmation"))return Response.redirect("".concat(n.origin,"?message=invalid-password"),302);o=yield bcrypt.hash(T,10),r=GenerateToken(24),yield t.settings.put("Password",o),yield t.settings.put("Token",r)}var k=parseInt((null===(s=i.get("max"))||void 0===s?void 0:s.toString())||"200");k<50&&(k=50),yield t.settings.put("MaxConfigs",k.toString()),yield t.settings.put("Protocols",null===(l=i.getAll("protocols"))||void 0===l?void 0:l.join("\n").trim()),yield t.settings.put("ALPNs",null!==(c=i.get("alpn_list_check"))&&void 0!==c&&c.toString()&&(null===(u=i.get("alpn_list"))||void 0===u?void 0:u.toString().trim().split("\n").map((e=>e.trim())).join("\n"))||""),yield t.settings.put("FingerPrints",null!==(p=i.get("fp_list_check"))&&void 0!==p&&p.toString()&&(null===(d=i.get("fp_list"))||void 0===d?void 0:d.toString().trim().split("\n").map((e=>e.trim())).join("\n"))||""),yield t.settings.put("Providers",null!==(f=i.get("providers_check"))&&void 0!==f&&f.toString()&&(null===(h=i.get("providers"))||void 0===h?void 0:h.toString().trim().split("\n").map((e=>e.trim())).join("\n"))||""),yield t.settings.put("Countries",null!==(g=i.get("countries_check"))&&void 0!==g&&g.toString()&&(null===(m=i.getAll("countries[]"))||void 0===m?void 0:m.join(","))||""),yield t.settings.put("CleanDomainIPs",null!==(y=i.get("clean_ips_check"))&&void 0!==y&&y.toString()&&(null===(v=i.get("clean_ips"))||void 0===v?void 0:v.toString().trim().split("\n").map((e=>e.trim())).join("\n"))||""),yield t.settings.put("Configs",null!==(b=i.get("configs_check"))&&void 0!==b&&b.toString()&&(null===(_=i.get("configs"))||void 0===_?void 0:_.toString().trim().split("\n").map((e=>e.trim())).join("\n"))||""),yield t.settings.put("IncludeOriginalConfigs",(null===(w=i.get("original"))||void 0===w?void 0:w.toString())||"no"),yield t.settings.put("IncludeMergedConfigs",(null===(E=i.get("merged"))||void 0===E?void 0:E.toString())||"no"),yield t.settings.put("BlockPorn",(null===(A=i.get("block_porn"))||void 0===A?void 0:A.toString())||"no"),yield t.settings.put("EnableFragments",(null===(S=i.get("enable_fragments"))||void 0===S?void 0:S.toString())||"no"),yield t.settings.put("Version",version)}else yield t.settings.delete("MaxConfigs"),yield t.settings.delete("Protocols"),yield t.settings.delete("ALPNs"),yield t.settings.delete("FingerPrints"),yield t.settings.delete("Providers"),yield t.settings.delete("Countries"),yield t.settings.delete("CleanDomainIPs"),yield t.settings.delete("Configs"),yield t.settings.delete("IncludeOriginalConfigs"),yield t.settings.delete("IncludeMergedConfigs"),yield t.settings.delete("UUID"),yield t.settings.delete("Password"),yield t.settings.delete("Token"),yield t.settings.delete("BlockPorn"),yield t.settings.delete("EnableFragments");return Response.redirect("".concat(n.origin,"?message=success").concat(r?"&token="+r:""),302)}catch(e){return Response.redirect("".concat(n.origin,"?message=error").concat(r?"&token="+r:""),302)}}))).apply(this,arguments)}init_modules_watch_stub();var bcrypt2=__toESM(require_bcrypt());function GetLogin(e,t){return _GetLogin.apply(this,arguments)}function _GetLogin(){return(_GetLogin=_asyncToGenerator((function*(e,t){var n="";"error"==new URL(e.url).searchParams.get("message")&&(n='<div class="p-3 bg-danger text-white fw-bold text-center">Invalid password /    !</div>');var r='\n  <!DOCTYPE html>\n  <html>\n    <head>\n      <meta charset="utf8" />\n      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">\n    </head>\n    <body dir="ltr">\n      <div class="container border p-0">\n        <div class="p-3 bg-primary text-white">\n          <div class="text-nowrap fs-4 fw-bold text-center">V2RAY Worker - Control Panel</div>\n          <div class="text-nowrap fs-6 text-center">\n            Version '.concat(version,"\n          </div>\n        </div>\n        ").concat(n,'\n        <form class="mt-5 p-3 row g-3" method="post">\n          <div class="col-auto">\n            Enter password /     :\n          </div>\n          <div class="col-auto">\n            <label for="inputPassword2" class="visually-hidden">Password</label>\n            <input type="password" class="form-control" id="inputPassword2" placeholder="Password" name="password" minlength="6" required>\n          </div>\n          <div class="col-auto">\n            <button type="submit" class="btn btn-primary mb-3">Confirm identity /  </button>\n          </div>\n        </form>\n      </div>\n    </body>\n  </html>\n  ');return new Response(r,{headers:{"Content-Type":"text/html"}})}))).apply(this,arguments)}function PostLogin(e,t){return _PostLogin.apply(this,arguments)}function _PostLogin(){return(_PostLogin=_asyncToGenerator((function*(e,t){var n=new URL(e.url),r=(yield e.formData()).get("password")||"",i=(yield t.settings.get("Password"))||"";if(yield Delay(1e3),yield bcrypt2.compare(r,i)){var o=GenerateToken(24);return yield t.settings.put("Token",o),Response.redirect("".concat(n.protocol,"//").concat(n.hostname).concat("443"!=n.port?":"+n.port:"","/?token=").concat(o),302)}return Response.redirect("".concat(n.protocol,"//").concat(n.hostname).concat("443"!=n.port?":"+n.port:"","/login?message=error"),302)}))).apply(this,arguments)}function isNothing(e){return null==e}function isObject(e){return"object"==typeof e&&null!==e}function toArray(e){return Array.isArray(e)?e:isNothing(e)?[]:[e]}function extend(e,t){var n,r,i,o;if(t)for(n=0,r=(o=Object.keys(t)).length;n<r;n+=1)e[i=o[n]]=t[i];return e}function repeat(e,t){var n,r="";for(n=0;n<t;n+=1)r+=e;return r}function isNegativeZero(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e}init_modules_watch_stub(),init_modules_watch_stub();var isNothing_1=isNothing,isObject_1=isObject,toArray_1=toArray,repeat_1=repeat,isNegativeZero_1=isNegativeZero,extend_1=extend,common={isNothing:isNothing_1,isObject:isObject_1,toArray:toArray_1,repeat:repeat_1,isNegativeZero:isNegativeZero_1,extend:extend_1};function formatError(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+="\n\n"+e.mark.snippet),r+" "+n):r}function YAMLException$1(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=formatError(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}YAMLException$1.prototype=Object.create(Error.prototype),YAMLException$1.prototype.constructor=YAMLException$1,YAMLException$1.prototype.toString=function(e){return this.name+": "+formatError(this,e)};var exception=YAMLException$1;function getLine(e,t,n,r,i){var o="",a="",s=Math.floor(i/2)-1;return r-t>s&&(t=r-s+(o=" ... ").length),n-r>s&&(n=r+s-(a=" ...").length),{str:o+e.slice(t,n).replace(/\t/g,"")+a,pos:r-t+o.length}}function padStart(e,t){return common.repeat(" ",t-e.length)+e}function makeSnippet(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var n,r=/\r?\n|\r|\0/g,i=[0],o=[],a=-1;n=r.exec(e.buffer);)o.push(n.index),i.push(n.index+n[0].length),e.position<=n.index&&a<0&&(a=i.length-2);a<0&&(a=i.length-1);var s,l,c="",u=Math.min(e.line+t.linesAfter,o.length).toString().length,p=t.maxLength-(t.indent+u+3);for(s=1;s<=t.linesBefore&&!(a-s<0);s++)l=getLine(e.buffer,i[a-s],o[a-s],e.position-(i[a]-i[a-s]),p),c=common.repeat(" ",t.indent)+padStart((e.line-s+1).toString(),u)+" | "+l.str+"\n"+c;for(l=getLine(e.buffer,i[a],o[a],e.position,p),c+=common.repeat(" ",t.indent)+padStart((e.line+1).toString(),u)+" | "+l.str+"\n",c+=common.repeat("-",t.indent+u+3+l.pos)+"^\n",s=1;s<=t.linesAfter&&!(a+s>=o.length);s++)l=getLine(e.buffer,i[a+s],o[a+s],e.position-(i[a]-i[a+s]),p),c+=common.repeat(" ",t.indent)+padStart((e.line+s+1).toString(),u)+" | "+l.str+"\n";return c.replace(/\n$/,"")}var snippet=makeSnippet,TYPE_CONSTRUCTOR_OPTIONS=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],YAML_NODE_KINDS=["scalar","sequence","mapping"];function compileStyleAliases(e){var t={};return null!==e&&Object.keys(e).forEach((function(n){e[n].forEach((function(e){t[String(e)]=n}))})),t}function Type$1(e,t){if(t=t||{},Object.keys(t).forEach((function(t){if(-1===TYPE_CONSTRUCTOR_OPTIONS.indexOf(t))throw new exception('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')})),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=compileStyleAliases(t.styleAliases||null),-1===YAML_NODE_KINDS.indexOf(this.kind))throw new exception('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var type=Type$1;function compileList(e,t){var n=[];return e[t].forEach((function(e){var t=n.length;n.forEach((function(n,r){n.tag===e.tag&&n.kind===e.kind&&n.multi===e.multi&&(t=r)})),n[t]=e})),n}function compileMap(){var e,t,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function r(e){e.multi?(n.multi[e.kind].push(e),n.multi.fallback.push(e)):n[e.kind][e.tag]=n.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(r);return n}function Schema$1(e){return this.extend(e)}Schema$1.prototype.extend=function(e){var t=[],n=[];if(e instanceof type)n.push(e);else if(Array.isArray(e))n=n.concat(e);else{if(!e||!Array.isArray(e.implicit)&&!Array.isArray(e.explicit))throw new exception("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit))}t.forEach((function(e){if(!(e instanceof type))throw new exception("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new exception("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new exception("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")})),n.forEach((function(e){if(!(e instanceof type))throw new exception("Specified list of YAML types (or a single Type object) contains a non-Type object.")}));var r=Object.create(Schema$1.prototype);return r.implicit=(this.implicit||[]).concat(t),r.explicit=(this.explicit||[]).concat(n),r.compiledImplicit=compileList(r,"implicit"),r.compiledExplicit=compileList(r,"explicit"),r.compiledTypeMap=compileMap(r.compiledImplicit,r.compiledExplicit),r};var schema=Schema$1,str=new type("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),seq=new type("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),map=new type("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}}),failsafe=new schema({explicit:[str,seq,map]});function resolveYamlNull(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)}function constructYamlNull(){return null}function isNull(e){return null===e}var _null=new type("tag:yaml.org,2002:null",{kind:"scalar",resolve:resolveYamlNull,construct:constructYamlNull,predicate:isNull,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function resolveYamlBoolean(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)}function constructYamlBoolean(e){return"true"===e||"True"===e||"TRUE"===e}function isBoolean(e){return"[object Boolean]"===Object.prototype.toString.call(e)}var bool=new type("tag:yaml.org,2002:bool",{kind:"scalar",resolve:resolveYamlBoolean,construct:constructYamlBoolean,predicate:isBoolean,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function isHexCode(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function isOctCode(e){return 48<=e&&e<=55}function isDecCode(e){return 48<=e&&e<=57}function resolveYamlInteger(e){if(null===e)return!1;var t,n=e.length,r=0,i=!1;if(!n)return!1;if("-"!==(t=e[r])&&"+"!==t||(t=e[++r]),"0"===t){if(r+1===n)return!0;if("b"===(t=e[++r])){for(r++;r<n;r++)if("_"!==(t=e[r])){if("0"!==t&&"1"!==t)return!1;i=!0}return i&&"_"!==t}if("x"===t){for(r++;r<n;r++)if("_"!==(t=e[r])){if(!isHexCode(e.charCodeAt(r)))return!1;i=!0}return i&&"_"!==t}if("o"===t){for(r++;r<n;r++)if("_"!==(t=e[r])){if(!isOctCode(e.charCodeAt(r)))return!1;i=!0}return i&&"_"!==t}}if("_"===t)return!1;for(;r<n;r++)if("_"!==(t=e[r])){if(!isDecCode(e.charCodeAt(r)))return!1;i=!0}return!(!i||"_"===t)}function constructYamlInteger(e){var t,n=e,r=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),"-"!==(t=n[0])&&"+"!==t||("-"===t&&(r=-1),t=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===t){if("b"===n[1])return r*parseInt(n.slice(2),2);if("x"===n[1])return r*parseInt(n.slice(2),16);if("o"===n[1])return r*parseInt(n.slice(2),8)}return r*parseInt(n,10)}function isInteger(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!common.isNegativeZero(e)}var int=new type("tag:yaml.org,2002:int",{kind:"scalar",resolve:resolveYamlInteger,construct:constructYamlInteger,predicate:isInteger,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),YAML_FLOAT_PATTERN=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function resolveYamlFloat(e){return null!==e&&!(!YAML_FLOAT_PATTERN.test(e)||"_"===e[e.length-1])}function constructYamlFloat(e){var t,n;return n="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:n*parseFloat(t,10)}var SCIENTIFIC_WITHOUT_DOT=/^[-+]?[0-9]+e/;function representYamlFloat(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(common.isNegativeZero(e))return"-0.0";return n=e.toString(10),SCIENTIFIC_WITHOUT_DOT.test(n)?n.replace("e",".e"):n}function isFloat(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||common.isNegativeZero(e))}var float=new type("tag:yaml.org,2002:float",{kind:"scalar",resolve:resolveYamlFloat,construct:constructYamlFloat,predicate:isFloat,represent:representYamlFloat,defaultStyle:"lowercase"}),json=failsafe.extend({implicit:[_null,bool,int,float]}),core=json,YAML_DATE_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),YAML_TIMESTAMP_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function resolveYamlTimestamp(e){return null!==e&&(null!==YAML_DATE_REGEXP.exec(e)||null!==YAML_TIMESTAMP_REGEXP.exec(e))}function constructYamlTimestamp(e){var t,n,r,i,o,a,s,l,c=0,u=null;if(null===(t=YAML_DATE_REGEXP.exec(e))&&(t=YAML_TIMESTAMP_REGEXP.exec(e)),null===t)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(n,r,i));if(o=+t[4],a=+t[5],s=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(u=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(u=-u)),l=new Date(Date.UTC(n,r,i,o,a,s,c)),u&&l.setTime(l.getTime()-u),l}function representYamlTimestamp(e){return e.toISOString()}var timestamp=new type("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:resolveYamlTimestamp,construct:constructYamlTimestamp,instanceOf:Date,represent:representYamlTimestamp});function resolveYamlMerge(e){return"<<"===e||null===e}var merge=new type("tag:yaml.org,2002:merge",{kind:"scalar",resolve:resolveYamlMerge}),BASE64_MAP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";function resolveYamlBinary(e){if(null===e)return!1;var t,n,r=0,i=e.length,o=BASE64_MAP;for(n=0;n<i;n++)if(!((t=o.indexOf(e.charAt(n)))>64)){if(t<0)return!1;r+=6}return r%8==0}function constructYamlBinary(e){var t,n,r=e.replace(/[\r\n=]/g,""),i=r.length,o=BASE64_MAP,a=0,s=[];for(t=0;t<i;t++)t%4==0&&t&&(s.push(a>>16&255),s.push(a>>8&255),s.push(255&a)),a=a<<6|o.indexOf(r.charAt(t));return 0===(n=i%4*6)?(s.push(a>>16&255),s.push(a>>8&255),s.push(255&a)):18===n?(s.push(a>>10&255),s.push(a>>2&255)):12===n&&s.push(a>>4&255),new Uint8Array(s)}function representYamlBinary(e){var t,n,r="",i=0,o=e.length,a=BASE64_MAP;for(t=0;t<o;t++)t%3==0&&t&&(r+=a[i>>18&63],r+=a[i>>12&63],r+=a[i>>6&63],r+=a[63&i]),i=(i<<8)+e[t];return 0===(n=o%3)?(r+=a[i>>18&63],r+=a[i>>12&63],r+=a[i>>6&63],r+=a[63&i]):2===n?(r+=a[i>>10&63],r+=a[i>>4&63],r+=a[i<<2&63],r+=a[64]):1===n&&(r+=a[i>>2&63],r+=a[i<<4&63],r+=a[64],r+=a[64]),r}function isBinary(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)}var binary=new type("tag:yaml.org,2002:binary",{kind:"scalar",resolve:resolveYamlBinary,construct:constructYamlBinary,predicate:isBinary,represent:representYamlBinary}),_hasOwnProperty$3=Object.prototype.hasOwnProperty,_toString$2=Object.prototype.toString;function resolveYamlOmap(e){if(null===e)return!0;var t,n,r,i,o,a=[],s=e;for(t=0,n=s.length;t<n;t+=1){if(r=s[t],o=!1,"[object Object]"!==_toString$2.call(r))return!1;for(i in r)if(_hasOwnProperty$3.call(r,i)){if(o)return!1;o=!0}if(!o)return!1;if(-1!==a.indexOf(i))return!1;a.push(i)}return!0}function constructYamlOmap(e){return null!==e?e:[]}var omap=new type("tag:yaml.org,2002:omap",{kind:"sequence",resolve:resolveYamlOmap,construct:constructYamlOmap}),_toString$1=Object.prototype.toString;function resolveYamlPairs(e){if(null===e)return!0;var t,n,r,i,o,a=e;for(o=new Array(a.length),t=0,n=a.length;t<n;t+=1){if(r=a[t],"[object Object]"!==_toString$1.call(r))return!1;if(1!==(i=Object.keys(r)).length)return!1;o[t]=[i[0],r[i[0]]]}return!0}function constructYamlPairs(e){if(null===e)return[];var t,n,r,i,o,a=e;for(o=new Array(a.length),t=0,n=a.length;t<n;t+=1)r=a[t],i=Object.keys(r),o[t]=[i[0],r[i[0]]];return o}var pairs=new type("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:resolveYamlPairs,construct:constructYamlPairs}),_hasOwnProperty$2=Object.prototype.hasOwnProperty;function resolveYamlSet(e){if(null===e)return!0;var t,n=e;for(t in n)if(_hasOwnProperty$2.call(n,t)&&null!==n[t])return!1;return!0}function constructYamlSet(e){return null!==e?e:{}}var set=new type("tag:yaml.org,2002:set",{kind:"mapping",resolve:resolveYamlSet,construct:constructYamlSet}),_default=core.extend({implicit:[timestamp,merge],explicit:[binary,omap,pairs,set]}),_hasOwnProperty$1=Object.prototype.hasOwnProperty,CONTEXT_FLOW_IN=1,CONTEXT_FLOW_OUT=2,CONTEXT_BLOCK_IN=3,CONTEXT_BLOCK_OUT=4,CHOMPING_CLIP=1,CHOMPING_STRIP=2,CHOMPING_KEEP=3,PATTERN_NON_PRINTABLE=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,PATTERN_NON_ASCII_LINE_BREAKS=/[\x85\u2028\u2029]/,PATTERN_FLOW_INDICATORS=/[,\[\]\{\}]/,PATTERN_TAG_HANDLE=/^(?:!|!!|![a-z\-]+!)$/i,PATTERN_TAG_URI=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function _class(e){return Object.prototype.toString.call(e)}function is_EOL(e){return 10===e||13===e}function is_WHITE_SPACE(e){return 9===e||32===e}function is_WS_OR_EOL(e){return 9===e||32===e||10===e||13===e}function is_FLOW_INDICATOR(e){return 44===e||91===e||93===e||123===e||125===e}function fromHexCode(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function escapedHexLen(e){return 120===e?2:117===e?4:85===e?8:0}function fromDecimalCode(e){return 48<=e&&e<=57?e-48:-1}function simpleEscapeSequence(e){return 48===e?"\0":97===e?"":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"":95===e?"":76===e?"\u2028":80===e?"\u2029":""}function charFromCodepoint(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}var i,simpleEscapeCheck=new Array(256),simpleEscapeMap=new Array(256);for(i=0;i<256;i++)simpleEscapeCheck[i]=simpleEscapeSequence(i)?1:0,simpleEscapeMap[i]=simpleEscapeSequence(i);function State$1(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||_default,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function generateError(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=snippet(n),new exception(t,n)}function throwError(e,t){throw generateError(e,t)}function throwWarning(e,t){e.onWarning&&e.onWarning.call(null,generateError(e,t))}var directiveHandlers={YAML:function(e,t,n){var r,i,o;null!==e.version&&throwError(e,"duplication of %YAML directive"),1!==n.length&&throwError(e,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(n[0]))&&throwError(e,"ill-formed argument of the YAML directive"),i=parseInt(r[1],10),o=parseInt(r[2],10),1!==i&&throwError(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=o<2,1!==o&&2!==o&&throwWarning(e,"unsupported YAML version of the document")},TAG:function(e,t,n){var r,i;2!==n.length&&throwError(e,"TAG directive accepts exactly two arguments"),r=n[0],i=n[1],PATTERN_TAG_HANDLE.test(r)||throwError(e,"ill-formed tag handle (first argument) of the TAG directive"),_hasOwnProperty$1.call(e.tagMap,r)&&throwError(e,'there is a previously declared suffix for "'+r+'" tag handle'),PATTERN_TAG_URI.test(i)||throwError(e,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch(t){throwError(e,"tag prefix is malformed: "+i)}e.tagMap[r]=i}};function captureSegment(e,t,n,r){var i,o,a,s;if(t<n){if(s=e.input.slice(t,n),r)for(i=0,o=s.length;i<o;i+=1)9===(a=s.charCodeAt(i))||32<=a&&a<=1114111||throwError(e,"expected valid JSON character");else PATTERN_NON_PRINTABLE.test(s)&&throwError(e,"the stream contains non-printable characters");e.result+=s}}function mergeMappings(e,t,n,r){var i,o,a,s;for(common.isObject(n)||throwError(e,"cannot merge mappings; the provided source object is unacceptable"),a=0,s=(i=Object.keys(n)).length;a<s;a+=1)o=i[a],_hasOwnProperty$1.call(t,o)||(t[o]=n[o],r[o]=!0)}function storeMappingPair(e,t,n,r,i,o,a,s,l){var c,u;if(Array.isArray(i))for(c=0,u=(i=Array.prototype.slice.call(i)).length;c<u;c+=1)Array.isArray(i[c])&&throwError(e,"nested arrays are not supported inside keys"),"object"==typeof i&&"[object Object]"===_class(i[c])&&(i[c]="[object Object]");if("object"==typeof i&&"[object Object]"===_class(i)&&(i="[object Object]"),i=String(i),null===t&&(t={}),"tag:yaml.org,2002:merge"===r)if(Array.isArray(o))for(c=0,u=o.length;c<u;c+=1)mergeMappings(e,t,o[c],n);else mergeMappings(e,t,o,n);else e.json||_hasOwnProperty$1.call(n,i)||!_hasOwnProperty$1.call(t,i)||(e.line=a||e.line,e.lineStart=s||e.lineStart,e.position=l||e.position,throwError(e,"duplicated mapping key")),"__proto__"===i?Object.defineProperty(t,i,{configurable:!0,enumerable:!0,writable:!0,value:o}):t[i]=o,delete n[i];return t}function readLineBreak(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):throwError(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function skipSeparationSpace(e,t,n){for(var r=0,i=e.input.charCodeAt(e.position);0!==i;){for(;is_WHITE_SPACE(i);)9===i&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&35===i)do{i=e.input.charCodeAt(++e.position)}while(10!==i&&13!==i&&0!==i);if(!is_EOL(i))break;for(readLineBreak(e),i=e.input.charCodeAt(e.position),r++,e.lineIndent=0;32===i;)e.lineIndent++,i=e.input.charCodeAt(++e.position)}return-1!==n&&0!==r&&e.lineIndent<n&&throwWarning(e,"deficient indentation"),r}function testDocumentSeparator(e){var t,n=e.position;return!(45!==(t=e.input.charCodeAt(n))&&46!==t||t!==e.input.charCodeAt(n+1)||t!==e.input.charCodeAt(n+2)||(n+=3,0!==(t=e.input.charCodeAt(n))&&!is_WS_OR_EOL(t)))}function writeFoldedLines(e,t){1===t?e.result+=" ":t>1&&(e.result+=common.repeat("\n",t-1))}function readPlainScalar(e,t,n){var r,i,o,a,s,l,c,u,p=e.kind,d=e.result;if(is_WS_OR_EOL(u=e.input.charCodeAt(e.position))||is_FLOW_INDICATOR(u)||35===u||38===u||42===u||33===u||124===u||62===u||39===u||34===u||37===u||64===u||96===u)return!1;if((63===u||45===u)&&(is_WS_OR_EOL(r=e.input.charCodeAt(e.position+1))||n&&is_FLOW_INDICATOR(r)))return!1;for(e.kind="scalar",e.result="",i=o=e.position,a=!1;0!==u;){if(58===u){if(is_WS_OR_EOL(r=e.input.charCodeAt(e.position+1))||n&&is_FLOW_INDICATOR(r))break}else if(35===u){if(is_WS_OR_EOL(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&testDocumentSeparator(e)||n&&is_FLOW_INDICATOR(u))break;if(is_EOL(u)){if(s=e.line,l=e.lineStart,c=e.lineIndent,skipSeparationSpace(e,!1,-1),e.lineIndent>=t){a=!0,u=e.input.charCodeAt(e.position);continue}e.position=o,e.line=s,e.lineStart=l,e.lineIndent=c;break}}a&&(captureSegment(e,i,o,!1),writeFoldedLines(e,e.line-s),i=o=e.position,a=!1),is_WHITE_SPACE(u)||(o=e.position+1),u=e.input.charCodeAt(++e.position)}return captureSegment(e,i,o,!1),!!e.result||(e.kind=p,e.result=d,!1)}function readSingleQuotedScalar(e,t){var n,r,i;if(39!==(n=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,r=i=e.position;0!==(n=e.input.charCodeAt(e.position));)if(39===n){if(captureSegment(e,r,e.position,!0),39!==(n=e.input.charCodeAt(++e.position)))return!0;r=e.position,e.position++,i=e.position}else is_EOL(n)?(captureSegment(e,r,i,!0),writeFoldedLines(e,skipSeparationSpace(e,!1,t)),r=i=e.position):e.position===e.lineStart&&testDocumentSeparator(e)?throwError(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);throwError(e,"unexpected end of the stream within a single quoted scalar")}function readDoubleQuotedScalar(e,t){var n,r,i,o,a,s;if(34!==(s=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;0!==(s=e.input.charCodeAt(e.position));){if(34===s)return captureSegment(e,n,e.position,!0),e.position++,!0;if(92===s){if(captureSegment(e,n,e.position,!0),is_EOL(s=e.input.charCodeAt(++e.position)))skipSeparationSpace(e,!1,t);else if(s<256&&simpleEscapeCheck[s])e.result+=simpleEscapeMap[s],e.position++;else if((a=escapedHexLen(s))>0){for(i=a,o=0;i>0;i--)(a=fromHexCode(s=e.input.charCodeAt(++e.position)))>=0?o=(o<<4)+a:throwError(e,"expected hexadecimal character");e.result+=charFromCodepoint(o),e.position++}else throwError(e,"unknown escape sequence");n=r=e.position}else is_EOL(s)?(captureSegment(e,n,r,!0),writeFoldedLines(e,skipSeparationSpace(e,!1,t)),n=r=e.position):e.position===e.lineStart&&testDocumentSeparator(e)?throwError(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}throwError(e,"unexpected end of the stream within a double quoted scalar")}function readFlowCollection(e,t){var n,r,i,o,a,s,l,c,u,p,d,f,h=!0,g=e.tag,m=e.anchor,y=Object.create(null);if(91===(f=e.input.charCodeAt(e.position)))a=93,c=!1,o=[];else{if(123!==f)return!1;a=125,c=!0,o={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=o),f=e.input.charCodeAt(++e.position);0!==f;){if(skipSeparationSpace(e,!0,t),(f=e.input.charCodeAt(e.position))===a)return e.position++,e.tag=g,e.anchor=m,e.kind=c?"mapping":"sequence",e.result=o,!0;h?44===f&&throwError(e,"expected the node content, but found ','"):throwError(e,"missed comma between flow collection entries"),d=null,s=l=!1,63===f&&is_WS_OR_EOL(e.input.charCodeAt(e.position+1))&&(s=l=!0,e.position++,skipSeparationSpace(e,!0,t)),n=e.line,r=e.lineStart,i=e.position,composeNode(e,t,CONTEXT_FLOW_IN,!1,!0),p=e.tag,u=e.result,skipSeparationSpace(e,!0,t),f=e.input.charCodeAt(e.position),!l&&e.line!==n||58!==f||(s=!0,f=e.input.charCodeAt(++e.position),skipSeparationSpace(e,!0,t),composeNode(e,t,CONTEXT_FLOW_IN,!1,!0),d=e.result),c?storeMappingPair(e,o,y,p,u,d,n,r,i):s?o.push(storeMappingPair(e,null,y,p,u,d,n,r,i)):o.push(u),skipSeparationSpace(e,!0,t),44===(f=e.input.charCodeAt(e.position))?(h=!0,f=e.input.charCodeAt(++e.position)):h=!1}throwError(e,"unexpected end of the stream within a flow collection")}function readBlockScalar(e,t){var n,r,i,o,a=CHOMPING_CLIP,s=!1,l=!1,c=t,u=0,p=!1;if(124===(o=e.input.charCodeAt(e.position)))r=!1;else{if(62!==o)return!1;r=!0}for(e.kind="scalar",e.result="";0!==o;)if(43===(o=e.input.charCodeAt(++e.position))||45===o)CHOMPING_CLIP===a?a=43===o?CHOMPING_KEEP:CHOMPING_STRIP:throwError(e,"repeat of a chomping mode identifier");else{if(!((i=fromDecimalCode(o))>=0))break;0===i?throwError(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):l?throwError(e,"repeat of an indentation width identifier"):(c=t+i-1,l=!0)}if(is_WHITE_SPACE(o)){do{o=e.input.charCodeAt(++e.position)}while(is_WHITE_SPACE(o));if(35===o)do{o=e.input.charCodeAt(++e.position)}while(!is_EOL(o)&&0!==o)}for(;0!==o;){for(readLineBreak(e),e.lineIndent=0,o=e.input.charCodeAt(e.position);(!l||e.lineIndent<c)&&32===o;)e.lineIndent++,o=e.input.charCodeAt(++e.position);if(!l&&e.lineIndent>c&&(c=e.lineIndent),is_EOL(o))u++;else{if(e.lineIndent<c){a===CHOMPING_KEEP?e.result+=common.repeat("\n",s?1+u:u):a===CHOMPING_CLIP&&s&&(e.result+="\n");break}for(r?is_WHITE_SPACE(o)?(p=!0,e.result+=common.repeat("\n",s?1+u:u)):p?(p=!1,e.result+=common.repeat("\n",u+1)):0===u?s&&(e.result+=" "):e.result+=common.repeat("\n",u):e.result+=common.repeat("\n",s?1+u:u),s=!0,l=!0,u=0,n=e.position;!is_EOL(o)&&0!==o;)o=e.input.charCodeAt(++e.position);captureSegment(e,n,e.position,!1)}}return!0}function readBlockSequence(e,t){var n,r,i=e.tag,o=e.anchor,a=[],s=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=a),r=e.input.charCodeAt(e.position);0!==r&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,throwError(e,"tab characters must not be used in indentation")),45===r)&&is_WS_OR_EOL(e.input.charCodeAt(e.position+1));)if(s=!0,e.position++,skipSeparationSpace(e,!0,-1)&&e.lineIndent<=t)a.push(null),r=e.input.charCodeAt(e.position);else if(n=e.line,composeNode(e,t,CONTEXT_BLOCK_IN,!1,!0),a.push(e.result),skipSeparationSpace(e,!0,-1),r=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&0!==r)throwError(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!s&&(e.tag=i,e.anchor=o,e.kind="sequence",e.result=a,!0)}function readBlockMapping(e,t,n){var r,i,o,a,s,l,c,u=e.tag,p=e.anchor,d={},f=Object.create(null),h=null,g=null,m=null,y=!1,v=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=d),c=e.input.charCodeAt(e.position);0!==c;){if(y||-1===e.firstTabInLine||(e.position=e.firstTabInLine,throwError(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),o=e.line,63!==c&&58!==c||!is_WS_OR_EOL(r)){if(a=e.line,s=e.lineStart,l=e.position,!composeNode(e,n,CONTEXT_FLOW_OUT,!1,!0))break;if(e.line===o){for(c=e.input.charCodeAt(e.position);is_WHITE_SPACE(c);)c=e.input.charCodeAt(++e.position);if(58===c)is_WS_OR_EOL(c=e.input.charCodeAt(++e.position))||throwError(e,"a whitespace character is expected after the key-value separator within a block mapping"),y&&(storeMappingPair(e,d,f,h,g,null,a,s,l),h=g=m=null),v=!0,y=!1,i=!1,h=e.tag,g=e.result;else{if(!v)return e.tag=u,e.anchor=p,!0;throwError(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!v)return e.tag=u,e.anchor=p,!0;throwError(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===c?(y&&(storeMappingPair(e,d,f,h,g,null,a,s,l),h=g=m=null),v=!0,y=!0,i=!0):y?(y=!1,i=!0):throwError(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,c=r;if((e.line===o||e.lineIndent>t)&&(y&&(a=e.line,s=e.lineStart,l=e.position),composeNode(e,t,CONTEXT_BLOCK_OUT,!0,i)&&(y?g=e.result:m=e.result),y||(storeMappingPair(e,d,f,h,g,m,a,s,l),h=g=m=null),skipSeparationSpace(e,!0,-1),c=e.input.charCodeAt(e.position)),(e.line===o||e.lineIndent>t)&&0!==c)throwError(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return y&&storeMappingPair(e,d,f,h,g,null,a,s,l),v&&(e.tag=u,e.anchor=p,e.kind="mapping",e.result=d),v}function readTagProperty(e){var t,n,r,i,o=!1,a=!1;if(33!==(i=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&throwError(e,"duplication of a tag property"),60===(i=e.input.charCodeAt(++e.position))?(o=!0,i=e.input.charCodeAt(++e.position)):33===i?(a=!0,n="!!",i=e.input.charCodeAt(++e.position)):n="!",t=e.position,o){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&62!==i);e.position<e.length?(r=e.input.slice(t,e.position),i=e.input.charCodeAt(++e.position)):throwError(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==i&&!is_WS_OR_EOL(i);)33===i&&(a?throwError(e,"tag suffix cannot contain exclamation marks"):(n=e.input.slice(t-1,e.position+1),PATTERN_TAG_HANDLE.test(n)||throwError(e,"named tag handle cannot contain such characters"),a=!0,t=e.position+1)),i=e.input.charCodeAt(++e.position);r=e.input.slice(t,e.position),PATTERN_FLOW_INDICATORS.test(r)&&throwError(e,"tag suffix cannot contain flow indicator characters")}r&&!PATTERN_TAG_URI.test(r)&&throwError(e,"tag name cannot contain such characters: "+r);try{r=decodeURIComponent(r)}catch(t){throwError(e,"tag name is malformed: "+r)}return o?e.tag=r:_hasOwnProperty$1.call(e.tagMap,n)?e.tag=e.tagMap[n]+r:"!"===n?e.tag="!"+r:"!!"===n?e.tag="tag:yaml.org,2002:"+r:throwError(e,'undeclared tag handle "'+n+'"'),!0}function readAnchorProperty(e){var t,n;if(38!==(n=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&throwError(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!is_WS_OR_EOL(n)&&!is_FLOW_INDICATOR(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&throwError(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function readAlias(e){var t,n,r;if(42!==(r=e.input.charCodeAt(e.position)))return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;0!==r&&!is_WS_OR_EOL(r)&&!is_FLOW_INDICATOR(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&throwError(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),_hasOwnProperty$1.call(e.anchorMap,n)||throwError(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],skipSeparationSpace(e,!0,-1),!0}function composeNode(e,t,n,r,i){var o,a,s,l,c,u,p,d,f,h=1,g=!1,m=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,o=a=s=CONTEXT_BLOCK_OUT===n||CONTEXT_BLOCK_IN===n,r&&skipSeparationSpace(e,!0,-1)&&(g=!0,e.lineIndent>t?h=1:e.lineIndent===t?h=0:e.lineIndent<t&&(h=-1)),1===h)for(;readTagProperty(e)||readAnchorProperty(e);)skipSeparationSpace(e,!0,-1)?(g=!0,s=o,e.lineIndent>t?h=1:e.lineIndent===t?h=0:e.lineIndent<t&&(h=-1)):s=!1;if(s&&(s=g||i),1!==h&&CONTEXT_BLOCK_OUT!==n||(d=CONTEXT_FLOW_IN===n||CONTEXT_FLOW_OUT===n?t:t+1,f=e.position-e.lineStart,1===h?s&&(readBlockSequence(e,f)||readBlockMapping(e,f,d))||readFlowCollection(e,d)?m=!0:(a&&readBlockScalar(e,d)||readSingleQuotedScalar(e,d)||readDoubleQuotedScalar(e,d)?m=!0:readAlias(e)?(m=!0,null===e.tag&&null===e.anchor||throwError(e,"alias node should not have any properties")):readPlainScalar(e,d,CONTEXT_FLOW_IN===n)&&(m=!0,null===e.tag&&(e.tag="?")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===h&&(m=s&&readBlockSequence(e,f))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&throwError(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),l=0,c=e.implicitTypes.length;l<c;l+=1)if((p=e.implicitTypes[l]).resolve(e.result)){e.result=p.construct(e.result),e.tag=p.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if(_hasOwnProperty$1.call(e.typeMap[e.kind||"fallback"],e.tag))p=e.typeMap[e.kind||"fallback"][e.tag];else for(p=null,l=0,c=(u=e.typeMap.multi[e.kind||"fallback"]).length;l<c;l+=1)if(e.tag.slice(0,u[l].tag.length)===u[l].tag){p=u[l];break}p||throwError(e,"unknown tag !<"+e.tag+">"),null!==e.result&&p.kind!==e.kind&&throwError(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+p.kind+'", not "'+e.kind+'"'),p.resolve(e.result,e.tag)?(e.result=p.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):throwError(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||m}function readDocument(e){var t,n,r,i,o=e.position,a=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(i=e.input.charCodeAt(e.position))&&(skipSeparationSpace(e,!0,-1),i=e.input.charCodeAt(e.position),!(e.lineIndent>0||37!==i));){for(a=!0,i=e.input.charCodeAt(++e.position),t=e.position;0!==i&&!is_WS_OR_EOL(i);)i=e.input.charCodeAt(++e.position);for(r=[],(n=e.input.slice(t,e.position)).length<1&&throwError(e,"directive name must not be less than one character in length");0!==i;){for(;is_WHITE_SPACE(i);)i=e.input.charCodeAt(++e.position);if(35===i){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&!is_EOL(i));break}if(is_EOL(i))break;for(t=e.position;0!==i&&!is_WS_OR_EOL(i);)i=e.input.charCodeAt(++e.position);r.push(e.input.slice(t,e.position))}0!==i&&readLineBreak(e),_hasOwnProperty$1.call(directiveHandlers,n)?directiveHandlers[n](e,n,r):throwWarning(e,'unknown document directive "'+n+'"')}skipSeparationSpace(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,skipSeparationSpace(e,!0,-1)):a&&throwError(e,"directives end mark is expected"),composeNode(e,e.lineIndent-1,CONTEXT_BLOCK_OUT,!1,!0),skipSeparationSpace(e,!0,-1),e.checkLineBreaks&&PATTERN_NON_ASCII_LINE_BREAKS.test(e.input.slice(o,e.position))&&throwWarning(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&testDocumentSeparator(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,skipSeparationSpace(e,!0,-1)):e.position<e.length-1&&throwError(e,"end of the stream or a document separator is expected")}function loadDocuments(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var n=new State$1(e,t),r=e.indexOf("\0");for(-1!==r&&(n.position=r,throwError(n,"null byte is not allowed in input")),n.input+="\0";32===n.input.charCodeAt(n.position);)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)readDocument(n);return n.documents}function loadAll$1(e,t,n){null!==t&&"object"==typeof t&&void 0===n&&(n=t,t=null);var r=loadDocuments(e,n);if("function"!=typeof t)return r;for(var i=0,o=r.length;i<o;i+=1)t(r[i])}function load$1(e,t){var n=loadDocuments(e,t);if(0!==n.length){if(1===n.length)return n[0];throw new exception("expected a single document in the stream, but found more")}}var loadAll_1=loadAll$1,load_1=load$1,loader={loadAll:loadAll_1,load:load_1},_toString=Object.prototype.toString,_hasOwnProperty=Object.prototype.hasOwnProperty,CHAR_BOM=65279,CHAR_TAB=9,CHAR_LINE_FEED=10,CHAR_CARRIAGE_RETURN=13,CHAR_SPACE=32,CHAR_EXCLAMATION=33,CHAR_DOUBLE_QUOTE=34,CHAR_SHARP=35,CHAR_PERCENT=37,CHAR_AMPERSAND=38,CHAR_SINGLE_QUOTE=39,CHAR_ASTERISK=42,CHAR_COMMA=44,CHAR_MINUS=45,CHAR_COLON=58,CHAR_EQUALS=61,CHAR_GREATER_THAN=62,CHAR_QUESTION=63,CHAR_COMMERCIAL_AT=64,CHAR_LEFT_SQUARE_BRACKET=91,CHAR_RIGHT_SQUARE_BRACKET=93,CHAR_GRAVE_ACCENT=96,CHAR_LEFT_CURLY_BRACKET=123,CHAR_VERTICAL_LINE=124,CHAR_RIGHT_CURLY_BRACKET=125,ESCAPE_SEQUENCES={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},DEPRECATED_BOOLEANS_SYNTAX=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],DEPRECATED_BASE60_SYNTAX=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function compileStyleMap(e,t){var n,r,i,o,a,s,l;if(null===t)return{};for(n={},i=0,o=(r=Object.keys(t)).length;i<o;i+=1)a=r[i],s=String(t[a]),"!!"===a.slice(0,2)&&(a="tag:yaml.org,2002:"+a.slice(2)),(l=e.compiledTypeMap.fallback[a])&&_hasOwnProperty.call(l.styleAliases,s)&&(s=l.styleAliases[s]),n[a]=s;return n}function encodeHex(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else{if(!(e<=4294967295))throw new exception("code point within a string may not be greater than 0xFFFFFFFF");n="U",r=8}return"\\"+n+common.repeat("0",r-t.length)+t}var QUOTING_TYPE_SINGLE=1,QUOTING_TYPE_DOUBLE=2;function State(e){this.schema=e.schema||_default,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=common.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=compileStyleMap(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType='"'===e.quotingType?QUOTING_TYPE_DOUBLE:QUOTING_TYPE_SINGLE,this.forceQuotes=e.forceQuotes||!1,this.replacer="function"==typeof e.replacer?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function indentString(e,t){for(var n,r=common.repeat(" ",t),i=0,o=-1,a="",s=e.length;i<s;)-1===(o=e.indexOf("\n",i))?(n=e.slice(i),i=s):(n=e.slice(i,o+1),i=o+1),n.length&&"\n"!==n&&(a+=r),a+=n;return a}function generateNextLine(e,t){return"\n"+common.repeat(" ",e.indent*t)}function testImplicitResolving(e,t){var n,r;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(e.implicitTypes[n].resolve(t))return!0;return!1}function isWhitespace(e){return e===CHAR_SPACE||e===CHAR_TAB}function isPrintable(e){return 32<=e&&e<=126||161<=e&&e<=55295&&8232!==e&&8233!==e||57344<=e&&e<=65533&&e!==CHAR_BOM||65536<=e&&e<=1114111}function isNsCharOrWhitespace(e){return isPrintable(e)&&e!==CHAR_BOM&&e!==CHAR_CARRIAGE_RETURN&&e!==CHAR_LINE_FEED}function isPlainSafe(e,t,n){var r=isNsCharOrWhitespace(e),i=r&&!isWhitespace(e);return(n?r:r&&e!==CHAR_COMMA&&e!==CHAR_LEFT_SQUARE_BRACKET&&e!==CHAR_RIGHT_SQUARE_BRACKET&&e!==CHAR_LEFT_CURLY_BRACKET&&e!==CHAR_RIGHT_CURLY_BRACKET)&&e!==CHAR_SHARP&&!(t===CHAR_COLON&&!i)||isNsCharOrWhitespace(t)&&!isWhitespace(t)&&e===CHAR_SHARP||t===CHAR_COLON&&i}function isPlainSafeFirst(e){return isPrintable(e)&&e!==CHAR_BOM&&!isWhitespace(e)&&e!==CHAR_MINUS&&e!==CHAR_QUESTION&&e!==CHAR_COLON&&e!==CHAR_COMMA&&e!==CHAR_LEFT_SQUARE_BRACKET&&e!==CHAR_RIGHT_SQUARE_BRACKET&&e!==CHAR_LEFT_CURLY_BRACKET&&e!==CHAR_RIGHT_CURLY_BRACKET&&e!==CHAR_SHARP&&e!==CHAR_AMPERSAND&&e!==CHAR_ASTERISK&&e!==CHAR_EXCLAMATION&&e!==CHAR_VERTICAL_LINE&&e!==CHAR_EQUALS&&e!==CHAR_GREATER_THAN&&e!==CHAR_SINGLE_QUOTE&&e!==CHAR_DOUBLE_QUOTE&&e!==CHAR_PERCENT&&e!==CHAR_COMMERCIAL_AT&&e!==CHAR_GRAVE_ACCENT}function isPlainSafeLast(e){return!isWhitespace(e)&&e!==CHAR_COLON}function codePointAt(e,t){var n,r=e.charCodeAt(t);return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1))>=56320&&n<=57343?1024*(r-55296)+n-56320+65536:r}function needIndentIndicator(e){return/^\n* /.test(e)}var STYLE_PLAIN=1,STYLE_SINGLE=2,STYLE_LITERAL=3,STYLE_FOLDED=4,STYLE_DOUBLE=5;function chooseScalarStyle(e,t,n,r,i,o,a,s){var l,c=0,u=null,p=!1,d=!1,f=-1!==r,h=-1,g=isPlainSafeFirst(codePointAt(e,0))&&isPlainSafeLast(codePointAt(e,e.length-1));if(t||a)for(l=0;l<e.length;c>=65536?l+=2:l++){if(!isPrintable(c=codePointAt(e,l)))return STYLE_DOUBLE;g=g&&isPlainSafe(c,u,s),u=c}else{for(l=0;l<e.length;c>=65536?l+=2:l++){if((c=codePointAt(e,l))===CHAR_LINE_FEED)p=!0,f&&(d=d||l-h-1>r&&" "!==e[h+1],h=l);else if(!isPrintable(c))return STYLE_DOUBLE;g=g&&isPlainSafe(c,u,s),u=c}d=d||f&&l-h-1>r&&" "!==e[h+1]}return p||d?n>9&&needIndentIndicator(e)?STYLE_DOUBLE:a?o===QUOTING_TYPE_DOUBLE?STYLE_DOUBLE:STYLE_SINGLE:d?STYLE_FOLDED:STYLE_LITERAL:!g||a||i(e)?o===QUOTING_TYPE_DOUBLE?STYLE_DOUBLE:STYLE_SINGLE:STYLE_PLAIN}function writeScalar(e,t,n,r,i){e.dump=function(){if(0===t.length)return e.quotingType===QUOTING_TYPE_DOUBLE?'""':"''";if(!e.noCompatMode&&(-1!==DEPRECATED_BOOLEANS_SYNTAX.indexOf(t)||DEPRECATED_BASE60_SYNTAX.test(t)))return e.quotingType===QUOTING_TYPE_DOUBLE?'"'+t+'"':"'"+t+"'";var o=e.indent*Math.max(1,n),a=-1===e.lineWidth?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-o),s=r||e.flowLevel>-1&&n>=e.flowLevel;switch(chooseScalarStyle(t,s,e.indent,a,(function(t){return testImplicitResolving(e,t)}),e.quotingType,e.forceQuotes&&!r,i)){case STYLE_PLAIN:return t;case STYLE_SINGLE:return"'"+t.replace(/'/g,"''")+"'";case STYLE_LITERAL:return"|"+blockHeader(t,e.indent)+dropEndingNewline(indentString(t,o));case STYLE_FOLDED:return">"+blockHeader(t,e.indent)+dropEndingNewline(indentString(foldString(t,a),o));case STYLE_DOUBLE:return'"'+escapeString(t)+'"';default:throw new exception("impossible error: invalid scalar style")}}()}function blockHeader(e,t){var n=needIndentIndicator(e)?String(t):"",r="\n"===e[e.length-1];return n+(r&&("\n"===e[e.length-2]||"\n"===e)?"+":r?"":"-")+"\n"}function dropEndingNewline(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}function foldString(e,t){for(var n,r,i,o=/(\n+)([^\n]*)/g,a=(n=-1!==(n=e.indexOf("\n"))?n:e.length,o.lastIndex=n,foldLine(e.slice(0,n),t)),s="\n"===e[0]||" "===e[0];i=o.exec(e);){var l=i[1],c=i[2];r=" "===c[0],a+=l+(s||r||""===c?"":"\n")+foldLine(c,t),s=r}return a}function foldLine(e,t){if(""===e||" "===e[0])return e;for(var n,r,i=/ [^ ]/g,o=0,a=0,s=0,l="";n=i.exec(e);)(s=n.index)-o>t&&(r=a>o?a:s,l+="\n"+e.slice(o,r),o=r+1),a=s;return l+="\n",e.length-o>t&&a>o?l+=e.slice(o,a)+"\n"+e.slice(a+1):l+=e.slice(o),l.slice(1)}function escapeString(e){for(var t,n="",r=0,i=0;i<e.length;r>=65536?i+=2:i++)r=codePointAt(e,i),!(t=ESCAPE_SEQUENCES[r])&&isPrintable(r)?(n+=e[i],r>=65536&&(n+=e[i+1])):n+=t||encodeHex(r);return n}function writeFlowSequence(e,t,n){var r,i,o,a="",s=e.tag;for(r=0,i=n.length;r<i;r+=1)o=n[r],e.replacer&&(o=e.replacer.call(n,String(r),o)),(writeNode(e,t,o,!1,!1)||void 0===o&&writeNode(e,t,null,!1,!1))&&(""!==a&&(a+=","+(e.condenseFlow?"":" ")),a+=e.dump);e.tag=s,e.dump="["+a+"]"}function writeBlockSequence(e,t,n,r){var i,o,a,s="",l=e.tag;for(i=0,o=n.length;i<o;i+=1)a=n[i],e.replacer&&(a=e.replacer.call(n,String(i),a)),(writeNode(e,t+1,a,!0,!0,!1,!0)||void 0===a&&writeNode(e,t+1,null,!0,!0,!1,!0))&&(r&&""===s||(s+=generateNextLine(e,t)),e.dump&&CHAR_LINE_FEED===e.dump.charCodeAt(0)?s+="-":s+="- ",s+=e.dump);e.tag=l,e.dump=s||"[]"}function writeFlowMapping(e,t,n){var r,i,o,a,s,l="",c=e.tag,u=Object.keys(n);for(r=0,i=u.length;r<i;r+=1)s="",""!==l&&(s+=", "),e.condenseFlow&&(s+='"'),a=n[o=u[r]],e.replacer&&(a=e.replacer.call(n,o,a)),writeNode(e,t,o,!1,!1)&&(e.dump.length>1024&&(s+="? "),s+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),writeNode(e,t,a,!1,!1)&&(l+=s+=e.dump));e.tag=c,e.dump="{"+l+"}"}function writeBlockMapping(e,t,n,r){var i,o,a,s,l,c,u="",p=e.tag,d=Object.keys(n);if(!0===e.sortKeys)d.sort();else if("function"==typeof e.sortKeys)d.sort(e.sortKeys);else if(e.sortKeys)throw new exception("sortKeys must be a boolean or a function");for(i=0,o=d.length;i<o;i+=1)c="",r&&""===u||(c+=generateNextLine(e,t)),s=n[a=d[i]],e.replacer&&(s=e.replacer.call(n,a,s)),writeNode(e,t+1,a,!0,!0,!0)&&((l=null!==e.tag&&"?"!==e.tag||e.dump&&e.dump.length>1024)&&(e.dump&&CHAR_LINE_FEED===e.dump.charCodeAt(0)?c+="?":c+="? "),c+=e.dump,l&&(c+=generateNextLine(e,t)),writeNode(e,t+1,s,!0,l)&&(e.dump&&CHAR_LINE_FEED===e.dump.charCodeAt(0)?c+=":":c+=": ",u+=c+=e.dump));e.tag=p,e.dump=u||"{}"}function detectType(e,t,n){var r,i,o,a,s,l;for(o=0,a=(i=n?e.explicitTypes:e.implicitTypes).length;o<a;o+=1)if(((s=i[o]).instanceOf||s.predicate)&&(!s.instanceOf||"object"==typeof t&&t instanceof s.instanceOf)&&(!s.predicate||s.predicate(t))){if(n?s.multi&&s.representName?e.tag=s.representName(t):e.tag=s.tag:e.tag="?",s.represent){if(l=e.styleMap[s.tag]||s.defaultStyle,"[object Function]"===_toString.call(s.represent))r=s.represent(t,l);else{if(!_hasOwnProperty.call(s.represent,l))throw new exception("!<"+s.tag+'> tag resolver accepts not "'+l+'" style');r=s.represent[l](t,l)}e.dump=r}return!0}return!1}function writeNode(e,t,n,r,i,o,a){e.tag=null,e.dump=n,detectType(e,n,!1)||detectType(e,n,!0);var s,l=_toString.call(e.dump),c=r;r&&(r=e.flowLevel<0||e.flowLevel>t);var u,p,d="[object Object]"===l||"[object Array]"===l;if(d&&(p=-1!==(u=e.duplicates.indexOf(n))),(null!==e.tag&&"?"!==e.tag||p||2!==e.indent&&t>0)&&(i=!1),p&&e.usedDuplicates[u])e.dump="*ref_"+u;else{if(d&&p&&!e.usedDuplicates[u]&&(e.usedDuplicates[u]=!0),"[object Object]"===l)r&&0!==Object.keys(e.dump).length?(writeBlockMapping(e,t,e.dump,i),p&&(e.dump="&ref_"+u+e.dump)):(writeFlowMapping(e,t,e.dump),p&&(e.dump="&ref_"+u+" "+e.dump));else if("[object Array]"===l)r&&0!==e.dump.length?(e.noArrayIndent&&!a&&t>0?writeBlockSequence(e,t-1,e.dump,i):writeBlockSequence(e,t,e.dump,i),p&&(e.dump="&ref_"+u+e.dump)):(writeFlowSequence(e,t,e.dump),p&&(e.dump="&ref_"+u+" "+e.dump));else{if("[object String]"!==l){if("[object Undefined]"===l)return!1;if(e.skipInvalid)return!1;throw new exception("unacceptable kind of an object to dump "+l)}"?"!==e.tag&&writeScalar(e,e.dump,t,o,c)}null!==e.tag&&"?"!==e.tag&&(s=encodeURI("!"===e.tag[0]?e.tag.slice(1):e.tag).replace(/!/g,"%21"),s="!"===e.tag[0]?"!"+s:"tag:yaml.org,2002:"===s.slice(0,18)?"!!"+s.slice(18):"!<"+s+">",e.dump=s+" "+e.dump)}return!0}function getDuplicateReferences(e,t){var n,r,i=[],o=[];for(inspectNode(e,i,o),n=0,r=o.length;n<r;n+=1)t.duplicates.push(i[o[n]]);t.usedDuplicates=new Array(r)}function inspectNode(e,t,n){var r,i,o;if(null!==e&&"object"==typeof e)if(-1!==(i=t.indexOf(e)))-1===n.indexOf(i)&&n.push(i);else if(t.push(e),Array.isArray(e))for(i=0,o=e.length;i<o;i+=1)inspectNode(e[i],t,n);else for(i=0,o=(r=Object.keys(e)).length;i<o;i+=1)inspectNode(e[r[i]],t,n)}function dump$1(e,t){var n=new State(t=t||{});n.noRefs||getDuplicateReferences(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),writeNode(n,0,r,!0,!0)?n.dump+"\n":""}var dump_1=dump$1,dumper={dump:dump_1};function renamed(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var Type=type,Schema=schema,FAILSAFE_SCHEMA=failsafe,JSON_SCHEMA=json,CORE_SCHEMA=core,DEFAULT_SCHEMA=_default,load=loader.load,loadAll=loader.loadAll,dump=dumper.dump,YAMLException=exception,types={binary:binary,float:float,map:map,null:_null,pairs:pairs,set:set,timestamp:timestamp,bool:bool,int:int,merge:merge,omap:omap,seq:seq,str:str},safeLoad=renamed("safeLoad","load"),safeLoadAll=renamed("safeLoadAll","loadAll"),safeDump=renamed("safeDump","dump"),jsYaml={Type:Type,Schema:Schema,FAILSAFE_SCHEMA:FAILSAFE_SCHEMA,JSON_SCHEMA:JSON_SCHEMA,CORE_SCHEMA:CORE_SCHEMA,DEFAULT_SCHEMA:DEFAULT_SCHEMA,load:load,loadAll:loadAll,dump:dump,YAMLException:YAMLException,types:types,safeLoad:safeLoad,safeLoadAll:safeLoadAll,safeDump:safeDump},js_yaml_default=jsYaml,import_buffer2=__toESM(require_buffer());init_modules_watch_stub();var import_buffer=__toESM(require_buffer());function MixConfig(e,t,n,r){var i=MuddleDomain(t.hostname);try{var o=_objectSpread({},e);if(!["ws","h2","http"].includes(o.network))throw new Error("Network is not supported!");if(!cfPorts.includes(o.port))throw new Error("Port is not matched!");var a=o.sni||o.host||o.address;if(IsIp(a))throw new Error("Invalid SNI!");if(a.toLocaleLowerCase().endsWith(".workers.dev")||a.toLocaleLowerCase().endsWith(".pages.dev"))throw new Error("Config is running on Cloudflare, Skipped!");o.remarks=o.remarks+"-worker";var s=o.path;return o.host=i,o.sni=i,o.address=n,o.path="/".concat(a,":").concat(o.port,"/").concat(s.replace(/^\//g,"")),o.merged=!0,o}catch(e){return null}}function EncodeConfig(e){try{if("vmess"==e.configType){var t={type:e.type,ps:e.remarks,add:e.address,port:e.port,id:e.uuid,aid:e.alterId||0,tls:e.tls,sni:e.sni,net:e.network,path:e.path,host:e.host,alpn:e.alpn,fp:e.fp};return"vmess://".concat(import_buffer.Buffer.from(JSON.stringify(t),"utf-8").toString("base64"))}if("vless"==e.configType)return"vless://".concat(e.uuid,"@").concat(e.address,":").concat(e.port,"?encryption=").concat(encodeURIComponent(e.encryption||"none"),"&type=").concat(e.network).concat(e.path?"&path="+encodeURIComponent(e.path):"").concat(e.host?"&host="+encodeURIComponent(e.host):"").concat(e.security?"&security="+encodeURIComponent(e.security):"").concat(e.flow?"&flow="+encodeURIComponent(e.flow):"").concat(e.pbk?"&pbk="+encodeURIComponent(e.pbk):"").concat(e.sid?"&sid="+encodeURIComponent(e.sid):"").concat(e.spx?"&spx="+encodeURIComponent(e.spx):"").concat(e.seed?"&seed="+encodeURIComponent(e.seed):"").concat(e.quicSecurity?"&quicSecurity="+encodeURIComponent(e.quicSecurity):"").concat(e.key?"&key="+encodeURIComponent(e.key):"").concat(e.mode?"&mode="+encodeURIComponent(e.mode):"").concat(e.authority?"&authority="+encodeURIComponent(e.authority):"").concat(e.headerType?"&headerType="+encodeURIComponent(e.headerType):"").concat(e.alpn?"&alpn="+encodeURIComponent(e.alpn):"").concat(e.fp?"&fp="+encodeURIComponent(e.fp):"").concat(e.fragment?"&fragment="+encodeURIComponent(e.fragment):"","&sni=").concat(encodeURIComponent(e.sni||e.host||e.address),"#").concat(encodeURIComponent(e.remarks));if("trojan"==e.configType)return"".concat(e.configType,"://").concat(e.password||e.uuid,"@").concat(e.address,":").concat(e.port,"?type=").concat(e.network).concat(e.cipher?"&cipher="+encodeURIComponent(e.cipher):"").concat(e.path?"&path="+e.path:"").concat(e.host?"&host="+e.host:"").concat(e.alpn?"&alpn="+encodeURIComponent(e.alpn):"").concat(e.fp?"&fp="+encodeURIComponent(e.fp):"").concat(e.tls?"&tls=1":"","&sni=").concat(encodeURIComponent(e.sni||e.host||e.address),"#").concat(encodeURIComponent(e.remarks))}catch(e){}return""}function DecodeConfig(e){var t=null;if(e.startsWith("vmess://"))try{var n,r,i,o,a,s,l,c,u,p=(null===(n=t=JSON.parse(import_buffer.Buffer.from(e.substring(8),"base64").toString("utf-8")))||void 0===n?void 0:n.type)||"";t={configType:"vmess",remarks:null===(r=t)||void 0===r?void 0:r.ps,address:t.add,port:parseInt(t.port),uuid:t.id,alterId:(null===(i=t)||void 0===i?void 0:i.aid)||0,security:(null===(o=t)||void 0===o?void 0:o.scy)||"auto",network:t.net,type:p==t.net?"":p,host:null===(a=t)||void 0===a?void 0:a.host,path:(null===(s=t)||void 0===s?void 0:s.path)||"",tls:(null===(l=t)||void 0===l?void 0:l.tls)||"",sni:(null===(c=t)||void 0===c?void 0:c.sni)||(null===(u=t)||void 0===u?void 0:u.host)}}catch(e){}else if(e.startsWith("vless://"))try{var d=new URL(e);t={configType:"vless",remarks:decodeURIComponent(d.hash.substring(1)),address:d.hostname,port:parseInt(d.port||("tls"==d.searchParams.get("tls")?"443":"80")),uuid:d.username,security:d.searchParams.get("security")||"",encryption:d.searchParams.get("encryption")||"none",type:d.searchParams.get("type")||"tcp",serviceName:d.searchParams.get("serviceName")||"",host:d.searchParams.get("host")||"",path:d.searchParams.get("path")||"",tls:"tls"==d.searchParams.get("security")?"tls":"",sni:d.searchParams.get("sni")||"",flow:d.searchParams.get("flow")||"",pbk:d.searchParams.get("pbk")||"",sid:d.searchParams.get("sid")||"",spx:d.searchParams.get("spx")||"",headerType:d.searchParams.get("headerType")||"",seed:d.searchParams.get("seed")||"",quicSecurity:d.searchParams.get("quicSecurity")||"",key:d.searchParams.get("key")||"",mode:d.searchParams.get("mode")||"",authority:d.searchParams.get("authority")||""}}catch(e){}return t}function ValidateConfig(e){try{if(["vmess","vless"].includes(e.configType)&&IsValidUUID(e.uuid)&&e.remarks)return!(!e.address&&!e.sni);if(["trojan"].includes(e.configType)&&(e.uuid||e.password)&&e.remarks)return!(!e.address&&!e.sni)}catch(e){}return!1}function GetConfigList(e,t){return _GetConfigList.apply(this,arguments)}function _GetConfigList(){return(_GetConfigList=_asyncToGenerator((function*(e,t){var n=200,r=20,i=[],o=[],a=[],s=[],l=!0,c=!0,u=[],p=[],d=!0,f=!1;try{var h,g,m,y,v;n=parseInt((yield t.settings.get("MaxConfigs"))||"200"),((yield t.settings.get("Version"))||"2.0")==version&&(i=yield t.settings.get("Protocols").then((e=>e?e.split("\n"):[])));var b="yes"==(yield t.settings.get("BlockPorn")),_=((yield t.settings.get("Countries"))||"").trim().length>0;b?(i=["built-in-vless"],n=r):_&&(i=["built-in-vless","built-in-trojan"],n=40),o=(null===(h=yield t.settings.get("Providers"))||void 0===h?void 0:h.split("\n").filter((e=>e.trim().length>0)))||[],a=(null===(g=yield t.settings.get("ALPNs"))||void 0===g?void 0:g.split("\n").filter((e=>e.trim().length>0)))||[],s=(null===(m=yield t.settings.get("FingerPrints"))||void 0===m?void 0:m.split("\n").filter((e=>e.trim().length>0)))||[],l="yes"==((yield t.settings.get("IncludeOriginalConfigs"))||"yes"),c="yes"==((yield t.settings.get("IncludeMergedConfigs"))||"yes")&&(i.includes("vmess")||i.includes("vless")),u=(null===(y=yield t.settings.get("CleanDomainIPs"))||void 0===y?void 0:y.split("\n").filter((e=>e.trim().length>0)))||[],d=null===(yield t.settings.get("MaxConfigs")),p=(null===(v=yield t.settings.get("Configs"))||void 0===v?void 0:v.split("\n").filter((e=>e.trim().length>0)))||[],f="yes"==(yield t.settings.get("EnableFragments"))}catch(e){}i=i.length?i:defaultProtocols,a=a.length?a:defaultALPNList,s=s.length?s:defaultPFList,u=u.length?u:[MuddleDomain(e.hostname)],i.includes("built-in-vless")&&(n-=r),i.includes("built-in-trojan")&&(n-=r),d&&(l=!0,c=!0),o.length||(o=yield fetch(providersUri).then((e=>e.text())).then((e=>e.trim().split("\n").filter((e=>e.trim().length>0))))),l&&c&&(n=Math.floor(n/2));var w=[],E=[],A=[],S=[],T=Math.floor(n/Object.keys(o).length);for(var k of o)try{var C=yield fetch(k).then((e=>e.text()));try{if(!(S=js_yaml_default.load(C).proxies).length)throw"no-yaml";S=S.filter((e=>i.includes(e.type))).filter(ValidateConfig)}catch(e){IsBase64(C)&&(C=import_buffer2.Buffer.from(C,"base64").toString("utf-8")),(S=C.split("\n").filter((e=>e.match(new RegExp("^(".concat(i.join("|"),")://"),"i"))))).length&&(S=S.map(DecodeConfig).filter(ValidateConfig))}c&&E.push({url:k,count:T,configs:S.filter((e=>["vmess","vless"].includes(e.configType))),mergedConfigs:null}),l&&w.push({url:k,count:T,configs:S})}catch(e){}u.length||(u=[MuddleDomain(e.hostname)]);var I=u[Math.floor(Math.random()*u.length)],L=function*(){var t=E[O];E[O].mergedConfigs=t.configs.map((n=>MixConfig(n,e,I,t.name))).filter((e=>(null==e?void 0:e.merged)&&(null==e?void 0:e.remarks)))};for(var O in E)yield*L();for(var x=0,P=0;P<5;P++)for(var R of E)R.count>R.mergedConfigs.length?(x=x+R.count-R.mergedConfigs.length,R.count=R.mergedConfigs.length):R.count<R.mergedConfigs.length&&x>0&&(R.count=R.count+Math.ceil(x/3),x-=Math.ceil(x/3));for(var B of E)A=A.concat(GetMultipleRandomElements(B.mergedConfigs,B.count));if(l){for(var N=0,U=0;U<5;U++)for(var M of w)M.count>M.configs.length?(N=N+M.count-M.configs.length,M.count=M.configs.length):M.count<M.configs.length&&N>0&&(M.count=M.count+Math.ceil(N/3),N-=Math.ceil(N/3));for(var H of w)A=A.concat(GetMultipleRandomElements(H.configs,H.count))}p.length&&(A=A.concat(p.map(DecodeConfig))),A=RemoveDuplicateConfigs(A.filter(ValidateConfig));var j=[],D=[],F=1;return i.includes("built-in-vless")&&(j=yield GetVlessConfigList(e.hostname,u,F,r,t),F+=r),i.includes("built-in-trojan")&&(D=yield GetTrojanConfigList(e.hostname,u,F,r,t),F+=r),A=(A=j.concat(D).concat(AddNumberToConfigs(A,F))).map((e=>(e.fp=s[Math.floor(Math.random()*s.length)],e.alpn=a[Math.floor(Math.random()*a.length)],f&&"tls"==e.tls&&(e.fragment="tlshello,".concat(fragmentsLengthList[Math.floor(Math.random()*fragmentsLengthList.length)],",").concat(fragmentsIntervalList[Math.floor(Math.random()*fragmentsIntervalList.length)])),e))),console.log(A),A}))).apply(this,arguments)}function ToYamlSubscription(e){var t=defaultClashConfig;t.proxies=e.map((e=>(e=>{var{merged:t}=e;return _objectWithoutProperties(e,_excluded)})(e)));var n=e.reduce(((e,t)=>(e[null!=t&&t.merged?"Worker":"Original"]||(e[null!=t&&t.merged?"Worker":"Original"]=[]),e[null!=t&&t.merged?"Worker":"Original"].push(t),e)),{}),r=[];for(var i in n)r[i]=n[i];var o=[{name:"All",type:"select",proxies:["All - UrlTest","All - Fallback","All - LoadBalance(ch)","All - LoadBalance(rr)"].concat(Object.keys(r))},{name:"All - UrlTest",type:"url-test",url:"http://clients3.google.com/generate_204",interval:600,proxies:Object.keys(r)},{name:"All - Fallback",type:"fallback",url:"http://clients3.google.com/generate_204",interval:600,proxies:Object.keys(r)},{name:"All - LoadBalance(ch)",type:"load-balance",strategy:"consistent-hashing",url:"http://clients3.google.com/generate_204",interval:600,proxies:Object.keys(r)},{name:"All - LoadBalance(rr)",type:"load-balance",strategy:"round-robin",url:"http://clients3.google.com/generate_204",interval:600,proxies:Object.keys(r)}];for(var a in r)o.push({name:a,type:"url-test",url:"http://clients3.google.com/generate_204",interval:600,proxies:r[a]});return t["proxy-groups"]=o,js_yaml_default.dump(t)}init_modules_watch_stub(),init_modules_watch_stub();var import_buffer3=__toESM(require_buffer());function ToRawSubscription(e){return e.map(EncodeConfig).join("\n")}function ToBase64Subscription(e){return import_buffer3.Buffer.from(e.map(EncodeConfig).join("\n"),"utf-8").toString("base64")}var worker_default=exports.default={fetch:(e,t)=>_asyncToGenerator((function*(){var n=new URL(e.url),r=n.pathname.replace(/^\/|\/$/g,""),i=r.toLowerCase();if(["sub","clash","raw"].includes(i)){var o=yield GetConfigList(n,t);return"clash"==i?new Response(ToYamlSubscription(o)):"raw"==i?new Response(ToRawSubscription(o)):new Response(ToBase64Subscription(o))}if("vless-ws"==i)return VlessOverWSHandler(e,n.hostname,t);if("trojan-ws"==i)return TrojanOverWSHandler(e,n.hostname,t);if("login"==i){if("GET"===e.method)return GetLogin(e,t);if("POST"===e.method)return PostLogin(e,t)}else{if(r)return fetch(new Request(new URL("https://"+r),e));if("GET"===e.method)return GetPanel(e,t);if("POST"===e.method)return PostPanel(e,t)}return new Response("Invalid request!")}))()};
/*! Bundled license information:

bcryptjs/dist/bcrypt.js:
  (**
   * @license bcrypt.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
   * Released under the Apache License, Version 2.0
   * see: https://github.com/dcodeIO/bcrypt.js for details
   *)

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

buffer/index.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)
*/